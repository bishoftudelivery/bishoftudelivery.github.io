<!DOCTYPE html>
<html lang="am" data-version="14.3" data-lang="am">
<head>
    <meta name="google-site-verification" content="Yo225u8qpEADrbmyCChQZ9zOZ9pNeUwm1meyq8ChHh4" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title id="page-title">ቢሾፍቱ ዴሊቨሪ | Bishoftu Delivery</title>
    <!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Bishoftu Delivery">
<link rel="apple-touch-icon" href="icons/icon-152x152.png">
    
  // Service Worker for Bishoftu Delivery - Fixed for GitHub Pages
// Version: 14.4
           
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { 
            --primary: #ff4500; 
            --primary-light: #ff6b35;
            --primary-dark: #cc3700;
            --secondary: #28a745;
            --secondary-light: #34ce57;
            --dark: #1a1a1a; 
            --light-dark: #333;
            --bg: #f8f9fa; 
            --card-bg: #ffffff;
            --text: #333;
            --text-light: #666;
            --text-lighter: #999;
            --border: #e0e0e0;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-light: 0 2px 8px rgba(0,0,0,0.05);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
            --transition: all 0.3s ease;
        }
        
        /* Modern Color Scheme */
        .primary-bg { background: var(--primary); color: white; }
        .secondary-bg { background: var(--secondary); color: white; }
        .light-bg { background: var(--bg); }
        .white-bg { background: white; }
        
        body { 
            font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, Arial, sans-serif; 
            margin: 0; 
            background: var(--bg); 
            padding-bottom: 100px; 
            direction: ltr; 
            overflow-x: hidden; 
            color: var(--text);
            line-height: 1.6;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Testing Notice */
        .testing-notice {
            background: linear-gradient(90deg, #ffeb3b, #ffd54f);
            color: #333;
            padding: 10px 15px;
            text-align: center;
            font-size: 0.8rem;
            border-bottom: 2px solid #ff9800;
            position: sticky;
            top: 0;
            z-index: 1001;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(255, 152, 0, 0.2);
        }
        
        /* Pull to Refresh Container */
        #refreshContainer {
            position: fixed;
            top: -60px;
            left: 0;
            width: 100%;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            color: white;
            z-index: 9999;
            transition: top 0.3s ease;
            box-shadow: 0 2px 10px rgba(255, 69, 0, 0.3);
        }
        
        .refresh-content {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .refresh-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            display: none;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Navigation */
        .main-nav {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 12px 15px;
            background: white;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 42px;
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .nav-btn {
            background: none;
            border: none;
            padding: 10px 18px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }
        .nav-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow-light);
        }
        .nav-btn:hover {
            background: #ff450010;
            transform: translateY(-1px);
        }
        
        /* Page Content */
        .page-content {
            display: none;
            animation: fadeIn 0.3s ease;
            min-height: 100vh;
        }
        .page-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Language Switcher */
        .lang-switcher {
            position: absolute;
            top: 55px;
            right: 15px;
            display: flex;
            gap: 5px;
            z-index: 1001;
            background: white;
            padding: 4px;
            border-radius: 20px;
            box-shadow: var(--shadow-light);
        }
        .lang-btn {
            background: white;
            border: 2px solid #ddd;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        .lang-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .lang-btn:hover {
            transform: scale(1.05);
        }
        
        /* Header */
        header { 
            background: white; 
            padding: 20px 15px 15px; 
            text-align: center; 
            position: relative; 
            z-index: 998; 
            margin-top: 15px; 
            border-bottom: 1px solid var(--border);
        }
        .streak-fire { 
            display: flex; 
            justify-content: center; 
            gap: 8px; 
            margin: 8px 0; 
        }
        .fire { 
            font-size: 24px; 
            filter: grayscale(100%); 
            opacity: 0.2; 
            transition: 0.5s; 
        }
        .fire.active { 
            filter: grayscale(0%); 
            opacity: 1; 
            animation: burn 1.5s infinite; 
        }
        @keyframes burn { 
            0%, 100% { transform: scale(1); } 
            50% { transform: scale(1.2); } 
        }

        .container { 
            max-width: 600px; 
            margin: auto; 
            padding: 15px; 
        }
        
        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 25px 0 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-light);
        }
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Restaurant Title */
        .res-title { 
            background: linear-gradient(90deg, var(--primary), var(--primary-light)); 
            color: white; 
            padding: 12px 15px; 
            border-radius: var(--radius-sm); 
            margin: 20px 0 15px; 
            font-size: 1.1rem; 
            font-weight: 600;
            box-shadow: var(--shadow-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Menu Grid - TWO COLUMNS FOR PHONES AND TABLETS */
        .menu-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
            margin-bottom: 20px;
        }
        
        /* Card Styles */
        .card { 
            background: var(--card-bg); 
            border-radius: var(--radius); 
            overflow: hidden; 
            box-shadow: var(--shadow-light); 
            position: relative; 
            display: flex; 
            flex-direction: column;
            transition: var(--transition);
            border: 1px solid var(--border);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        .card img { 
            width: 100%; 
            height: 130px; 
            object-fit: cover; 
            background: linear-gradient(45deg, #f5f5f5, #e0e0e0); 
        }
        .card-info { 
            padding: 12px; 
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .card-title { 
            font-size: 0.9rem; 
            font-weight: 600; 
            margin: 0 0 8px 0; 
            min-height: 40px; 
            color: var(--dark);
            line-height: 1.4;
        }
        .card-price { 
            display: none !important; 
        }
        .card input { 
            position: absolute; 
            top: 10px; 
            right: 10px; 
            width: 22px; 
            height: 22px; 
            accent-color: var(--primary);
            cursor: pointer;
            z-index: 2;
        }
        
        /* Trending Badge */
        .trending-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(90deg, var(--secondary), var(--secondary-light));
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            z-index: 1;
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        /* Payment Options in Modal - UPDATED FOR BETTER FIT */
        .payment-option {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 12px;
            margin: 10px 0;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .payment-option:hover {
            border-color: var(--primary-light);
            background: #ff450005;
        }
        .payment-option.selected {
            border-color: var(--primary);
            background: #ff450008;
        }
        .payment-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        .payment-details {
            flex: 1;
            min-width: 0;
        }
        .payment-title {
            font-weight: 600;
            margin: 0 0 3px 0;
            color: var(--dark);
            font-size: 0.9rem;
        }
        .payment-desc {
            font-size: 0.75rem;
            color: var(--text-light);
            margin: 0;
            line-height: 1.3;
        }
        
        /* Recent Orders Section - IMPROVED FOR ACTUAL FOOD ITEMS */
        .recent-orders {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-radius: var(--radius);
            padding: 18px;
            margin: 20px 0;
            border-left: 5px solid var(--primary);
            box-shadow: var(--shadow-light);
        }
        .recent-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        .recent-header i {
            color: var(--primary);
            font-size: 1.5rem;
        }
        .recent-header h3 {
            margin: 0;
            color: var(--dark);
            font-size: 1.2rem;
        }
        .recent-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        .recent-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-light);
            transition: var(--transition);
            cursor: pointer;
            text-align: center;
            height: 120px;
            overflow: hidden;
        }
        .recent-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .recent-image {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 8px;
            border: 2px solid var(--primary-light);
        }
        .recent-name {
            font-weight: 600;
            margin: 0;
            color: var(--dark);
            font-size: 0.7rem;
            line-height: 1.2;
            height: 32px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        /* Modal Style */
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(3px);
            animation: fadeIn 0.2s ease;
        }
        .modal-content { 
            background: white; 
            margin: 10% auto; 
            padding: 20px; 
            border-radius: var(--radius-lg); 
            width: 85%; 
            max-width: 400px; 
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlide 0.3s ease;
            max-height: 85vh;
            overflow-y: auto;
        }
        @keyframes modalSlide {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Preorder Time Selection Modal */
        .preorder-modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(3px);
            animation: fadeIn 0.2s ease;
        }
        .preorder-content { 
            background: white; 
            margin: 15% auto; 
            padding: 25px; 
            border-radius: var(--radius-lg); 
            width: 85%; 
            max-width: 400px; 
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlide 0.3s ease;
            max-height: 85vh;
            overflow-y: auto;
        }
        
        /* Preorder Time Options */
        .time-option {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        .time-option:hover {
            border-color: var(--primary-light);
            background: #ff450005;
        }
        .time-option.selected {
            border-color: var(--primary);
            background: #ff450008;
        }
        .time-slot {
            font-weight: 600;
            color: var(--dark);
            font-size: 1rem;
            margin-bottom: 5px;
        }
        .time-desc {
            font-size: 0.85rem;
            color: var(--text-light);
        }
        
        /* Location Modal */
        .location-modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(3px);
            animation: fadeIn 0.2s ease;
        }
        .location-content { 
            background: white; 
            margin: 15% auto; 
            padding: 25px; 
            border-radius: var(--radius-lg); 
            width: 85%; 
            max-width: 400px; 
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlide 0.3s ease;
            max-height: 85vh;
            overflow-y: auto;
        }
        
        /* Phone Modal */
        .phone-modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(3px);
            animation: fadeIn 0.2s ease;
        }
        .phone-content { 
            background: white; 
            margin: 15% auto; 
            padding: 25px; 
            border-radius: var(--radius-lg); 
            width: 85%; 
            max-width: 400px; 
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlide 0.3s ease;
            max-height: 85vh;
            overflow-y: auto;
        }
        
        /* Payment Modal - UPDATED FOR BETTER FIT */
        .payment-modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(3px);
            animation: fadeIn 0.2s ease;
        }
        .payment-content { 
            background: white; 
            margin: 10% auto; 
            padding: 20px; 
            border-radius: var(--radius-lg); 
            width: 90%; 
            max-width: 380px; 
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlide 0.3s ease;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .payment-info { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: var(--radius-sm); 
            margin: 15px 0; 
            text-align: left; 
            font-size: 0.9rem;
            border-left: 4px solid var(--primary);
            max-height: 150px;
            overflow-y: auto;
        }
        
        /* Order Type Buttons - UPDATED WITH NEW TEXT */
        .order-type-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        .order-type-btn {
            flex: 1;
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 12px 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        .order-type-btn:hover {
            border-color: var(--primary-light);
            background: #ff450005;
        }
        .order-type-btn.active {
            border-color: var(--primary);
            background: #ff450008;
        }
        .order-type-icon {
            font-size: 1.2rem;
            color: var(--primary);
        }
        .order-type-title {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--dark);
        }
        .order-type-price {
            font-size: 0.75rem;
            color: var(--secondary);
            font-weight: 600;
        }
        
        /* Floating Footer */
        .floating-footer { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            width: 100%; 
            background: white; 
            padding: 15px; 
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1); 
            z-index: 1000;
            display: flex;
            gap: 10px;
        }
        
        /* Buttons */
        .btn { 
            background: linear-gradient(90deg, var(--primary), var(--primary-light)); 
            color: white; 
            border: none; 
            width: 100%; 
            padding: 16px; 
            border-radius: var(--radius-sm); 
            font-size: 1rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-height: 50px;
        }
        .btn:hover {
            background: linear-gradient(90deg, var(--primary-dark), var(--primary));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.3);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn-secondary {
            background: var(--secondary);
        }
        .btn-secondary:hover {
            background: var(--secondary-light);
        }
        .btn-outline {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        .btn-outline:hover {
            background: #ff450008;
        }
        .btn-small {
            padding: 8px 15px;
            font-size: 0.85rem;
            min-height: auto;
        }
        
        /* Form Inputs */
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }
        input[type="text"], input[type="tel"], textarea, select { 
            width: 100%; 
            padding: 14px; 
            margin: 5px 0 0; 
            border: 1.5px solid var(--border); 
            border-radius: var(--radius-sm); 
            box-sizing: border-box; 
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
        }
        input[type="text"]:focus, input[type="tel"]:focus, textarea:focus, select:focus { 
            outline: none; 
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 69, 0, 0.1);
        }
        
        /* Info Pages Styling */
        .info-card {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow-light);
            border-top: 4px solid var(--primary);
        }
        .step-card {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            padding: 18px;
            background: #f8f9fa;
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--primary);
            transition: var(--transition);
        }
        .step-card:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-light);
        }
        .step-number {
            background: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: 700;
            flex-shrink: 0;
            font-size: 0.9rem;
        }
        .tracking-card {
            background: white;
            padding: 25px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            text-align: center;
            box-shadow: var(--shadow-light);
        }
        
        /* Contact Cards */
        .contact-card {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
            box-shadow: var(--shadow-light);
        }
        .telegram-track-btn {
            background: linear-gradient(90deg, #0088cc, #00a8ff);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin: 10px 0;
            font-weight: 600;
            transition: var(--transition);
        }
        .telegram-track-btn:hover {
            background: linear-gradient(90deg, #0077b3, #0097e6);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 136, 204, 0.3);
        }
        
        /* PWA Popup - IMPROVED FOR ALL DEVICES WITH INSTALL BUTTON */
        .pwa-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            z-index: 10001;
            width: 85%;
            max-width: 320px;
            text-align: center;
            animation: popupIn 0.3s ease;
            border: 2px solid var(--primary);
        }
        
        @keyframes popupIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        .pwa-icon {
            font-size: 50px;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .pwa-title {
            margin: 0 0 10px 0;
            color: var(--dark);
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .pwa-message {
            margin: 0 0 25px 0;
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .pwa-buttons {
            display: flex;
            gap: 10px;
        }
        
        .pwa-btn {
            flex: 1;
            padding: 14px 0;
            border-radius: var(--radius-sm);
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.95rem;
            transition: var(--transition);
        }
        
        .pwa-yes {
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            color: white;
        }
        
        .pwa-no {
            background: #f0f0f0;
            color: #666;
        }
        
        /* Offline Indicator */
        #offlineIndicator {
            position: fixed;
            top: 40px;
            left: 10px;
            background: #ff4444;
            color: white;
            padding: 8px 15px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            z-index: 10000;
            display: none;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(255, 68, 68, 0.3);
        }
        
        /* Delivery Fee Notice - UPDATED WITH NEW TEXT */
        .delivery-notice {
            background: #f0f9ff;
            padding: 15px;
            border-radius: var(--radius-sm);
            margin: 15px 0;
            border-left: 4px solid #0088cc;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            top: 90px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            color: white;
            padding: 14px 24px;
            border-radius: var(--radius);
            z-index: 10001;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            animation: fadeInOut 3s ease;
            display: none;
            font-weight: 500;
            text-align: center;
            max-width: 90%;
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            10%, 90% { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        
        /* Order Summary */
        .order-summary {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
            box-shadow: var(--shadow-light);
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }
        .summary-row:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 1.1rem;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid var(--primary);
        }
        
        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .stat-box {
            background: white;
            border-radius: var(--radius-sm);
            padding: 15px;
            text-align: center;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
        }
        .stat-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        /* Operating Hours Banner */
        .hours-banner {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            color: white;
            padding: 12px 15px;
            border-radius: var(--radius-sm);
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
            box-shadow: var(--shadow-light);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        /* RTL support for Oromo */
        body[data-lang="om"] {
            direction: rtl;
        }
        body[data-lang="om"] .lang-switcher {
            left: 15px;
            right: auto;
        }
        body[data-lang="om"] .step-card {
            border-left: none;
            border-right: 4px solid var(--primary);
        }
        body[data-lang="om"] .step-number {
            margin-right: 0;
            margin-left: 15px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .menu-grid {
                grid-template-columns: 1fr 1fr; /* TWO COLUMNS on tablets */
                gap: 12px;
            }
            .quick-stats {
                grid-template-columns: repeat(3, 1fr);
            }
            .payment-content {
                margin: 5% auto;
                padding: 18px;
                width: 92%;
                max-height: 85vh;
            }
            .preorder-content {
                margin: 10% auto;
                padding: 20px;
            }
            .order-type-buttons {
                flex-direction: column;
            }
        }
        
        @media (max-width: 480px) {
            .menu-grid {
                grid-template-columns: 1fr 1fr; /* TWO COLUMNS on phones */
                gap: 10px;
            }
            .floating-footer {
                flex-direction: column;
            }
            .quick-stats {
                grid-template-columns: repeat(3, 1fr);
            }
            .nav-btn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            .container {
                padding: 12px;
            }
            .modal-content {
                width: 92%;
                padding: 18px;
                margin: 5% auto;
            }
            .stat-box {
                padding: 12px;
            }
            .stat-number {
                font-size: 1.2rem;
            }
            .res-title {
                font-size: 1rem;
                padding: 10px 12px;
            }
            .card img {
                height: 110px; /* Slightly smaller images on mobile */
            }
            .recent-items {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
            .recent-image {
                width: 60px;
                height: 60px;
            }
            .recent-name {
                font-size: 0.65rem;
                height: 28px;
            }
            .payment-content {
                padding: 15px;
                margin: 10% auto;
                max-height: 90vh;
            }
            .payment-option {
                padding: 10px;
                margin: 8px 0;
            }
            .preorder-content {
                margin: 15% auto;
                padding: 18px;
            }
            .order-type-buttons {
                flex-direction: column;
            }
        }
        
        @media (max-width: 360px) {
            .menu-grid {
                grid-template-columns: 1fr 1fr; /* Still TWO COLUMNS on small phones */
                gap: 8px;
            }
            .card img {
                height: 100px;
            }
            .nav-btn {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
            .lang-btn {
                padding: 5px 10px;
                font-size: 0.7rem;
            }
            .recent-items {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }
            .recent-image {
                width: 55px;
                height: 55px;
            }
            .recent-name {
                font-size: 0.6rem;
            }
            .payment-content {
                margin: 15% auto;
                padding: 12px;
            }
            .preorder-content {
                margin: 20% auto;
                padding: 15px;
            }
            .order-type-buttons {
                flex-direction: column;
            }
        }
        
        /* Desktop/Laptop styles */
        @media (min-width: 1024px) {
            .container {
                max-width: 900px;
            }
            .menu-grid {
                grid-template-columns: repeat(3, 1fr); /* THREE columns on desktop */
                gap: 20px;
            }
            .card img {
                height: 150px;
            }
            .card-title {
                font-size: 1rem;
            }
            .nav-btn {
                padding: 12px 24px;
                font-size: 1rem;
            }
            .pwa-popup {
                max-width: 400px;
            }
        }
        
        /* Animation for adding items */
        @keyframes itemAdded {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .item-added {
            animation: itemAdded 0.3s ease;
        }
        
        /* Loading spinner */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 69, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
        }
        
        /* Price display */
        .price-display {
            background: #fff8e1;
            padding: 10px 15px;
            border-radius: var(--radius-sm);
            margin: 10px 0;
            border-left: 3px solid #ff9800;
        }
        
        /* Order type selected */
        .order-type-selected {
            background: #e8f5e9;
            padding: 10px;
            border-radius: var(--radius-sm);
            margin: 10px 0;
            border-left: 3px solid var(--secondary);
        }
        
        /* Restaurant distance indicator */
        .distance-indicator {
            position: absolute;
            top: 10px;
            right: 40px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            z-index: 1;
        }
        
        /* Install button for PWA */
        #installButton {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 69, 0, 0.3);
            z-index: 999;
            display: none;
            transition: var(--transition);
        }
        
        #installButton:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }
    </style>
</head>
<body>

<!-- Testing Notice -->
<div class="testing-notice" data-am="ፍላጎት ማሰባሰቢያ ነው። ለቢሾፍቱ ምግብ ማድረሻ ሀሳብ ነው።" data-om="Kun tajaajila nyaataa Bishooftu irratti madaala fedha fayyadamaa. Yaada qofaa dha.">
    This is a user interest gathering test for a potential food delivery idea in Bishoftu.
</div>

<!-- Pull to Refresh Container -->
<div id="refreshContainer">
    <div class="refresh-content">
        <div class="refresh-spinner" id="refreshSpinner"></div>
        <span id="refreshText" data-am="... ለማደስት ከላይ ይሳቡ" data-om="Deebi'aa... Harka keessan deebisuu fedhaa">ይቀናል... ለማደስት ከላይ ይሳቡ</span>
    </div>
</div>

<!-- Offline Indicator -->
<div id="offlineIndicator" data-am="ኦፍላይን ሁነዋል" data-om="Ilaalcha hin jiru">ኦፍላይን ሁነዋል</div>

<!-- Toast Notification -->
<div class="toast" id="toast"></div>

<!-- PWA Install Button (Floating) -->
<button id="installButton" title="Install App">
    <i class="fas fa-download"></i>
</button>

<!-- Language Switcher -->
<div class="lang-switcher">
    <button class="lang-btn active" onclick="switchLanguage('am')">አማርኛ</button>
    <button class="lang-btn" onclick="switchLanguage('om')">Afaan Oromoo</button>
</div>

<!-- Main Navigation -->
<nav class="main-nav">
    <button class="nav-btn active" onclick="showPage('home')" data-am="ኦርደር" data-om="Ordeer">ኦርደር</button>
    <button class="nav-btn" onclick="showPage('about')" data-am="ስለኛ" data-om="Waa'ee Keenya">ስለኛ</button>
    <button class="nav-btn" onclick="showPage('contact')" data-am="አግኙን" data-om="Nu Qunnamuu">አግኙን</button>
</nav>

<!-- Preorder Time Selection Modal -->
<div id="preorderModal" class="preorder-modal">
    <div class="preorder-content">
        <div style="font-size: 40px; margin-bottom: 15px; color: var(--primary);">
            <i class="fas fa-clock"></i>
        </div>
        <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; color: var(--dark);" 
             data-am="የቅድመ ትዕዛዝ ሰዓት ይምረጡ" 
             data-om="Yeroo Ordeeraa Duraa Filadhu">
            የቅድመ ትዕዛዝ ሰዓት ይምረጡ
        </div>
        <div style="margin-bottom: 25px; color: var(--text-light); line-height: 1.6;" 
             data-am="እባክዎ ምግብዎን መቀበል የሚፈልጉበትን ሰዓት ይምረጡ" 
             data-om="Yeroon nyaata keessan fudhachuu barbaaddan filadhu">
            እባክዎ ምግብዎን መቀበል የሚፈልጉበትን ሰዓት ይምረጡ
        </div>
        
        <!-- Time Options -->
        <div class="time-option" onclick="selectPreorderTime('slot1')" id="slot1Option">
            <div class="time-slot">4:30 PM - 6:30 PM</div>
            <div class="time-desc" data-am="ከ4:30 በፊት ትዕዛዝ ማድረግ አለቦት" data-om="4:30 duras ordeer gochuu qabdu">ከ4:30 በፊት ትዕዛዝ ማድረግ አለቦት</div>
        </div>
        
        <div class="time-option" onclick="selectPreorderTime('slot2')" id="slot2Option">
            <div class="time-slot">5:30 PM - 8:30 PM</div>
            <div class="time-desc" data-am="ከ5:30 በፊት ትዕዛዝ ማድረግ አለቦት" data-om="5:30 duras ordeer gochuu qabdu">ከ5:30 በፊት ትዕዛዝ ማድረግ አለቦት</div>
        </div>
        
        <div class="time-option" onclick="selectPreorderTime('slot3')" id="slot3Option">
            <div class="time-slot">9:30 PM - 11:00 PM</div>
            <div class="time-desc" data-am="ከ9:30 በፊት ትዕዛዝ ማድረግ አለቦት" data-om="9:30 duras ordeer gochuu qabdu">ከ9:30 በፊት ትዕዛዝ ማድረግ አለቦት</div>
        </div>
        
        <div style="margin-top: 25px; display: flex; gap: 10px;">
            <button class="btn" onclick="confirmPreorderTime()" 
                    data-am="አረጋግጥ" 
                    data-om="Mirkaneessi">
                <i class="fas fa-check"></i>
                <span>አረጋግጥ</span>
            </button>
            <button class="btn btn-outline" onclick="cancelPreorder()" 
                    data-am="ተመለስ" 
                    data-om="Deebi'i">
                <i class="fas fa-arrow-left"></i>
                <span>ተመለስ</span>
            </button>
        </div>
    </div>
</div>

<!-- Location Modal -->
<div id="locationModal" class="location-modal">
    <div class="location-content">
        <div style="font-size: 40px; margin-bottom: 15px; color: var(--primary);">
            <i class="fas fa-map-marker-alt"></i>
        </div>
        <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; color: var(--dark);" 
             data-am="አካባቢዎን ያሳውቁ" 
             data-om="Bakka keessan agarsiisaa">
            አካባቢዎን ያሳውቁ
        </div>
        <div style="margin-bottom: 25px; color: var(--text-light); line-height: 1.6;" 
             data-am="ምግብዎን በፍጥነት ለማድረስ እና ትክክለኛ የመላኪያ ክፍያ ለማስላት የእርስዎን አካባቢ ማወቅ አለብን።" 
             data-om="Nyaata keessan ariifachiifachuuf fi kaffaltii ergaa sirrii hiruuu bakka keessan beekuu barbaanna.">
            ምግብዎን በፍጥነት ለማድረስ እና ትክክለኛ የመላኪያ ክፍያ ለማስላት የእርስዎን አካባቢ ማወቅ አለብን።
        </div>
        
        <!-- Order Type Selection - UPDATED WITH NEW TEXT -->
        <div class="order-type-buttons">
            <div class="order-type-btn" onclick="selectOrderType('normal')" id="normalOrderBtn">
                <div class="order-type-icon"><i class="fas fa-bolt"></i></div>
                <div class="order-type-title" data-am="አሁን እዘዝ" data-om="Amma Ajaji">አሁን እዘዝ</div>
                <div class="order-type-price" data-am="50-99 ብር" data-om="50-99 Birraa">50-99 ብር</div>
            </div>
            <div class="order-type-btn" onclick="selectOrderType('preorder')" id="preorderBtn">
                <div class="order-type-icon"><i class="fas fa-clock"></i></div>
                <div class="order-type-title" data-am="ቅድመ ትዕዛዝ" data-om="Ordeer Duraa">ቅድመ ትዕዛዝ</div>
                <div class="order-type-price" data-am="50 ብር" data-om="50 Birraa">50 ብር</div>
            </div>
        </div>
        
        <div style="background: #f0f9ff; padding: 15px; border-radius: var(--radius-sm); margin-bottom: 20px; text-align: left; border-left: 3px solid var(--primary);">
            <div style="font-weight: 600; margin-bottom: 8px; color: var(--dark);" 
                 data-am="የመላኪያ ክፍያ" 
                 data-om="Kaffaltii ergaa">
                የመላኪያ ክፍያ
            </div>
            <div style="font-size: 0.9rem; color: var(--text-light);">
                <div data-am="• አሁን እዘዝ: 1 ኪ.ሜ ውስጥ 50 ብር, ከ1 ኪ.ሜ በላይ 99 ብር" data-om="• Amma Ajaji: Kilomeetira 1 keessatti 50 Birraa, Kilomeetira 1 ol 99 Birraa">• አሁን እዘዝ: 1 ኪ.ሜ ውስጥ 50 ብር, ከ1 ኪ.ሜ በላይ 99 ብር</div>
                <div data-am="• ቅድመ ትዕዛዝ: 50 ብር" data-om="• Ordeer Duraa: 50 Birraa">• ቅድመ ትዕዛዝ: 50 ብር</div>
                <div data-am="• የመጀመሪያ ማድረሻ ነፃ!" data-om="• Ergaa jalqabaa bilisaa!">• የመጀመሪያ ማድረሻ ነፃ!</div>
                <div data-am="• ከ10 ኪ.ሜ በላይ አይሰራም" data-om="• Kilomeetira 10 ol hin hojjetu">• ከ10 ኪ.ሜ በላይ አይሰራም</div>
            </div>
        </div>
        
        <div style="display: flex; gap: 10px;">
            <button class="btn" onclick="requestLocation()" 
                    data-am="አካባቢዬን ያሳውቁ" 
                    data-om="Bakka kiyya agarsiisi">
                <i class="fas fa-check"></i>
                <span>አካባቢዬን ያሳውቁ</span>
            </button>
            <button class="btn btn-outline" onclick="denyLocation()" 
                    data-am="አልፈልግም" 
                    data-om="Hin barbaadu">
                <i class="fas fa-times"></i>
                <span>አልፈልግም</span>
            </button>
        </div>
    </div>
</div>

<!-- Phone Number Modal -->
<div id="phoneModal" class="phone-modal">
    <div class="phone-content">
        <div style="font-size: 40px; margin-bottom: 15px; color: var(--primary);">
            <i class="fas fa-phone"></i>
        </div>
        <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; color: var(--dark);" 
             id="phoneModalTitle"
             data-am="ስልክ ቁጥር ያስገቡ" 
             data-om="Lakkoofsa bilbila galchi">
            ስልክ ቁጥር ያስገቡ
        </div>
        <div style="margin-bottom: 25px; color: var(--text-light); line-height: 1.6;" 
             id="phoneModalMessage"
             data-am="የትዕዛዝዎን ሁኔታ ለማሳወቅ የስልክ ቁጥርዎ ያስፈልጋል።" 
             data-om="Haala ordeeraa keessan himuuuf lakkoofsa bilbila keessan barbaachisaa dha.">
            የትዕዛዝዎን ሁኔታ ለማሳወቅ የስልክ ቁጥርዎ ያስፈልጋል።
        </div>
        
        <div style="margin-bottom: 20px;">
            <input type="tel" id="userPhone" 
                   placeholder="0912345678" 
                   style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: var(--radius-sm); font-size: 1rem;"
                   data-am-placeholder="0912345678"
                   data-om-placeholder="0912345678">
            <div style="font-size: 0.8rem; color: var(--text-light); margin-top: 5px; text-align: left;"
                 data-am="ለምሳሌ: 0912345678"
                 data-om="Fakkeenya: 0912345678">
                ለምሳሌ: 0912345678
            </div>
        </div>
        
        <div style="display: flex; gap: 10px;">
            <button class="btn" onclick="submitPhoneNumber()" 
                    data-am="አረጋግጥ" 
                    data-om="Mirkaneessi">
                <i class="fas fa-check"></i>
                <span>አረጋግጥ</span>
            </button>
            <button class="btn btn-outline" onclick="skipPhoneNumber()" 
                    data-am="ዝለል" 
                    data-om="Dabali">
                <i class="fas fa-forward"></i>
                <span>ዝለል</span>
            </button>
        </div>
    </div>
</div>

<!-- Payment Method Modal - UPDATED FOR BETTER FIT -->
<div id="paymentModal" class="payment-modal">
    <div class="payment-content">
        <div style="font-size: 40px; margin-bottom: 15px; color: var(--primary);">
            <i class="fas fa-credit-card"></i>
        </div>
        <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; color: var(--dark);" 
             data-am="የክፍያ ዘዴ ይምረጡ" 
             data-om="Kaffaltii Mala Filadhu">
            የክፍያ ዘዴ ይምረጡ
        </div>
        
        <!-- Order Type Display -->
        <div id="orderTypeDisplay" style="background: #e8f5e9; padding: 12px; border-radius: var(--radius-sm); margin-bottom: 15px; border-left: 3px solid var(--secondary);">
            <div style="font-weight: 600; color: var(--dark); font-size: 0.9rem;" id="orderTypeText">
                <!-- Will be populated by JavaScript -->
            </div>
            <div style="font-size: 0.8rem; color: var(--text-light); margin-top: 5px;" id="preorderTimeText">
                <!-- Will be populated for preorders -->
            </div>
        </div>
        
        <!-- Selected Restaurants -->
        <div id="selectedRestaurantsDisplay" style="background: #fff3e0; padding: 12px; border-radius: var(--radius-sm); margin-bottom: 15px; border-left: 3px solid #ff9800;">
            <div style="font-weight: 600; color: var(--dark); font-size: 0.9rem;" 
                 data-am="የተመረጡ ሬስቶራንቶች" 
                 data-om="Reestorantoota Filataman">
                የተመረጡ ሬስቶራንቶች
            </div>
            <div id="selectedRestaurantsList" style="font-size: 0.8rem; color: var(--text-light); margin-top: 5px;">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Delivery Fee Information -->
        <div id="deliveryFeeDisplay" style="background: #fff8e1; padding: 12px; border-radius: var(--radius-sm); margin-bottom: 15px; border-left: 3px solid #ff9800;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                <i class="fas fa-truck" style="color: #ff9800;"></i>
                <div style="font-weight: 600; color: var(--dark); font-size: 0.9rem;" 
                     data-am="የመላኪያ ክፍያ" 
                     data-om="Kaffaltii ergaa">
                    የመላኪያ ክፍያ
                </div>
            </div>
            <div id="deliveryFeeDetails" style="font-size: 0.8rem; color: var(--text-light);">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Order Summary -->
        <div id="orderSummaryModal" style="background: #f0f9ff; padding: 12px; border-radius: var(--radius-sm); margin-bottom: 15px; text-align: left; border-left: 3px solid var(--primary);">
            <div style="font-weight: 600; margin-bottom: 8px; color: var(--dark); font-size: 0.9rem;" 
                 data-am="የትዕዛዝ ማጠቃለያ" 
                 data-om="Giddu-galeessa Ordeeraa">
                የትዕዛዝ ማጠቃለያ
            </div>
            <div id="orderSummaryDetails" style="font-size: 0.8rem; color: var(--text-light);">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Payment Options -->
        <div class="payment-option" onclick="selectPaymentMethod('cash')" id="cashPaymentOption">
            <div class="payment-icon" style="background: #28a74520; color: #28a745;">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <div class="payment-details">
                <div class="payment-title" data-am="ክፍያ ከመላኪያ በኋላ" data-om="Kaffaltii Ergaa Booda">ክፍያ ከመላኪያ በኋላ</div>
                <div class="payment-desc" data-am="ምግቡን ከተቀበሉ በኋላ በገንዘብ ይክፈሉ" data-om="Nyaata fudhachuu keessan booda qarshii kaffala">ምግቡን ከተቀበሉ በኋላ በገንዘብ ይክፈሉ</div>
            </div>
            <i class="fas fa-check-circle" style="color: #28a745; font-size: 1.1rem; display: none;"></i>
        </div>
        
        <div class="payment-option" onclick="selectPaymentMethod('telegram')" id="telegramPaymentOption">
            <div class="payment-icon" style="background: #0088cc20; color: #0088cc;">
                <i class="fab fa-telegram"></i>
            </div>
            <div class="payment-details">
                <div class="payment-title" data-am="በቴሌግራም" data-om="Telegiraamiin">በቴሌግራም</div>
                <div class="payment-desc" data-am="በቴሌግራም ይክፈሉ" data-om="Telegiraamiin kaffala">በቴሌግራም ይክፈሉ</div>
            </div>
            <i class="fas fa-check-circle" style="color: #0088cc; font-size: 1.1rem; display: none;"></i>
        </div>
        
        <div style="margin-top: 20px; display: flex; gap: 10px;">
            <button class="btn" onclick="confirmPayment()" id="confirmPaymentBtn"
                    data-am="ትዕዛዝ ላክ" 
                    data-om="Ordeer Ergi">
                <i class="fas fa-paper-plane"></i>
                <span>ትዕዛዝ ላክ</span>
            </button>
            <button class="btn btn-outline" onclick="closePaymentModal()" 
                    data-am="ተመለስ" 
                    data-om="Deebi'i">
                <i class="fas fa-arrow-left"></i>
                <span>ተመለስ</span>
            </button>
        </div>
    </div>
</div>

<!-- PWA Popup - WILL SHOW AFTER 5 SECONDS (CHANGED FROM 10) -->
<div id="pwaPopup" class="pwa-popup">
    <div class="pwa-icon">📱</div>
    <div class="pwa-title" data-am="አፕ አርግ" data-om="App sirreessi">አፕ አርግ</div>
    <div class="pwa-message" data-am="ወደ ስልክዎ መነሻ ማውጫ ይጨምሩ ፈጣን መዳረሻ ያግኙ" data-om="Gaafa keessan irratti app ergaa sirreessaa saami argadhu">ወደ ስልክዎ መነሻ ማውጫ ይጨምሩ ፈጣን መዳረሻ ያግኙ</div>
    <div class="pwa-buttons">
        <button class="pwa-btn pwa-yes" onclick="installPWA()" data-am="ጫን" data-om="Sirreessi">ጫን</button>
        <button class="pwa-btn pwa-no" onclick="dismissPWA()" data-am="አትጫን" data-om="Hin sirreessin">አትጫን</button>
    </div>
</div>

<!-- HOME PAGE -->
<div id="homePage" class="page-content active">
    <header>
        <h1 style="margin:0; color:var(--dark); font-size: 1.8rem;" id="site-title" data-am="ቢሾፍቱ ዴሊቨሪ" data-om="Bishooftu Ergaa">ቢሾፍቱ ዴሊቨሪ</h1>
        <div class="streak-fire" id="fireIcons">
            <span class="fire" id="s1"></span><span class="fire" id="s2"></span><span class="fire" id="s3"></span>
        </div>
        <div id="statusMsg" style="font-size: 0.8rem; color: var(--text-light);" data-am="በየቀኑ በማዘዝ እሳቱን ያቀጣጥሉ!" data-om="Guyyaa guyyaan dhaadannoo godhaa ibidda tasgabbeessaa!">በየቀኑ በማዘዝ እሳቱን ያቀጣጥሉ!</div>
    </header>

    <div class="container">
        <!-- Operating Hours Banner -->
        <div class="hours-banner">
            <i class="fas fa-clock"></i>
            <span data-am="የስራ ሰዓት: 9:00 AM - 6:00 PM" data-om="Yeroo Hojii: 9:00 AM - 6:00 PM">የስራ ሰዓት: 9:00 AM - 6:00 PM</span>
        </div>

        <!-- Quick Stats -->
        <div class="quick-stats">
            <div class="stat-box">
                <div class="stat-number" id="ordersToday">14</div>
                <div class="stat-label" data-am="ትዕዛዞች" data-om="Ordeeron Har'a">ዛሬ ትዕዛዞች</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">30-45</div>
                <div class="stat-label" data-am="ደቂቃዎች" data-om="Daqiiqota">ደቂቃዎች</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="activeRiders">3</div>
                <div class="stat-label" data-am="ነጂዎች" data-om="Ergaa Eegtoota">ነጂዎች</div>
            </div>
        </div>

        <!-- Delivery Fee Notice - UPDATED WITH NEW TEXT -->
        <div class="delivery-notice">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <i class="fas fa-truck" style="color: var(--primary);"></i>
                <div style="font-weight: 600; color: var(--dark);" 
                     data-am="የመላኪያ ክፍያ" 
                     data-om="Kaffaltii ergaa">
                    የመላኪያ ክፍያ
                </div>
            </div>
            <div style="font-size: 0.9rem; color: var(--text-light);">
                <div data-am="• አሁን እዘዝ: 1 ኪ.ሜ ውስጥ 50 ብር, ከ1 ኪ.ሜ በላይ 99 ብር" data-om="• Amma Ajaji: Kilomeetira 1 keessatti 50 Birraa, Kilomeetira 1 ol 99 Birraa">• አሁን እዘዝ: 1 ኪ.ሜ ውስጥ 50 ብር, ከ1 ኪ.ሜ በላይ 99 ብር</div>
                <div data-am="• ቅድመ ትዕዛዝ: 50 ብር" data-om="• Ordeer Duraa: 50 Birraa">• ቅድመ ትዕዛዝ: 50 ብር</div>
                <div data-am="• የመጀመሪያ ማድረሻ ነፃ!" data-om="• Ergaa jalqabaa bilisaa!">• የመጀመሪያ ማድረሻ ነፃ!</div>
                <div data-am="• ከ10 ኪ.ሜ በላይ አይሰራም" data-om="• Kilomeetira 10 ol hin hojjetu">• ከ10 ኪ.ሜ በላይ አይሰራም</div>
            </div>
        </div>

        <!-- Recent Orders Section - IMPROVED FOR ACTUAL FOOD ITEMS -->
        <div class="recent-orders">
            <div class="recent-header">
                <i class="fas fa-history"></i>
                <h3 data-am="ያለፉት ትዕዛዞች" data-om="Ordeeron Darban">ያለፉት ትዕዛዞች</h3>
            </div>
            <div class="recent-items" id="recentItems">
                <!-- Recent items will be populated by JavaScript -->
                <div class="recent-item" style="justify-content: center; grid-column: span 3;" id="noRecentOrders">
                    <div style="font-size: 2rem; color: var(--text-lighter); margin-bottom: 10px;">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--text-light);" data-am="ምንም ያለፈ ትዕዛዝ የለም" data-om="Ordeer darban hin jiru">ምንም ያለፈ ትዕዛዝ የለም</div>
                </div>
            </div>
        </div>

        <!-- Restaurant Sections -->
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-utensils"></i>
                <span data-am="ምግቦች" data-om="Nyaatota">ምግቦች</span>
            </h2>
            <span style="font-size: 0.9rem; color: var(--text-light);" data-am="ምረጥ" data-om="Filadhu">ምረጥ</span>
        </div>

        <!-- CLASSIC NOODLES RESTAURANT -->
        <div class="res-title">
            <i class="fas fa-star"></i>
            <span data-am="Classic Noodles" data-om="Classic Noodles">Classic Noodles</span>
        </div>
        <div class="menu-grid" data-restaurant="Classic Noodles">
            <!-- Classic Noodles Burger Items -->
            <div class="card"><img src="./assets/classic-king-burger.webp?v=14.3" alt="Classic King Burger"><input type="checkbox" value="Classic King Burger (freshly grounded beef, chicken and fish, lettuce, tomato, onion and sliced cheddar cheese, served with French fries and ketchup)" data-price="810" data-restaurant="Classic Noodles" data-image="./assets/classic-king-burger.webp" data-shortname="Classic King Burger"><div class="card-info"><p class="card-title">Classic King Burger</p></div></div>
            
            <div class="card"><img src="./assets/classic-chicken-burger.webp?v=14.3" alt="Classic Chicken Burger"><input type="checkbox" value="Classic Chicken Burger (chicken breast, mayonnaise, lettuce special burger sauce, mustard, egg, black pepper, cheese served with french fries and ketchup)" data-price="705" data-restaurant="Classic Noodles" data-image="./assets/classic-chicken-burger.webp" data-shortname="Classic Chicken Burger"><div class="card-info"><p class="card-title">Classic Chicken Burger</p></div></div>
            
            <div class="card"><img src="./assets/double-cheese-burger.webp?v=14.3" alt="Double Cheese Burger"><input type="checkbox" value="Double Cheese Burger (Double layer freshly grounded beef, vegetable oil, cheddar cheese, mayonnaise, lettuce served with french fries and ketchup)" data-price="605" data-restaurant="Classic Noodles" data-image="./assets/double-cheese-burger.webp" data-shortname="Double Cheese Burger"><div class="card-info"><p class="card-title">Double Cheese Burger</p></div></div>
            
            <div class="card"><img src="./assets/classic-burger.webp?v=14.3" alt="Classic Burger"><input type="checkbox" value="Classic Burger (freshly ground beef, vegetable oil, cheddar cheese, mayonnaise, iceberg lettuce, caramelized onion and special burger sauce served with french fries and ketchup)" data-price="570" data-restaurant="Classic Noodles" data-image="./assets/classic-burger.webp" data-shortname="Classic Burger"><div class="card-info"><p class="card-title">Classic Burger</p></div></div>
            
            <div class="card"><img src="./assets/beef-burger-new.webp?v=14.3" alt="Beef Burger"><input type="checkbox" value="Beef Burger (Freshly ground beef, vegetable oil, mayonnaise, lettuce, onion, and special burger sauce served with french fries and ketchup)" data-price="475" data-restaurant="Classic Noodles" data-image="./assets/beef-burger-new.webp" data-shortname="Beef Burger"><div class="card-info"><p class="card-title">Beef Burger</p></div></div>
            
            <div class="card"><img src="./assets/cheese-burger-new.webp?v=14.3" alt="Cheese Burger"><input type="checkbox" value="Cheese Burger (Freshly ground beef, vegetable oil, cheddar cheese, mayonnaise, lettuce served with french fries and ketchup)" data-price="620" data-restaurant="Classic Noodles" data-image="./assets/cheese-burger-new.webp" data-shortname="Cheese Burger"><div class="card-info"><p class="card-title">Cheese Burger</p></div></div>
            
            <div class="card"><img src="./assets/hamburger-new.webp?v=14.3" alt="Hamburger"><input type="checkbox" value="Hamburger (Freshly ground beef, vegetable oil, cheddar cheese, mayonnaise, lettuce served with french fries and ketchup)" data-price="620" data-restaurant="Classic Noodles" data-image="./assets/hamburger-new.webp" data-shortname="Hamburger"><div class="card-info"><p class="card-title">Hamburger</p></div></div>
            
            <div class="card"><img src="./assets/double-beef-burger-new.webp?v=14.3" alt="Double Beef Burger"><input type="checkbox" value="Double Beef Burger (double layer freshly ground beef, vegetable oil, mayonnaise, lettuce, onion and special burger sauce served with french fries)" data-price="590" data-restaurant="Classic Noodles" data-image="./assets/double-beef-burger-new.webp" data-shortname="Double Beef Burger"><div class="card-info"><p class="card-title">Double Beef Burger</p></div></div>
            
            <div class="card"><img src="./assets/mixed-burger.webp?v=14.3" alt="Mixed Burger"><input type="checkbox" value="Mixed Burger (Freshly ground Beef, vegetable oil, cheddar cheese, mayonnaise, lettuce served with french fries and ketchup)" data-price="620" data-restaurant="Classic Noodles" data-image="./assets/mixed-burger.webp" data-shortname="Mixed Burger"><div class="card-info"><p class="card-title">Mixed Burger</p></div></div>
            
            <!-- Classic Noodles Pizza Items -->
            <div class="card"><img src="./assets/special-classic-pizza.webp?v=14.3" alt="Special Classic Pizza"><input type="checkbox" value="Special Classic Pizza (minced chicken and beef, boiled egg, garlic, olive oil, fresh tomato sauce)" data-price="795" data-restaurant="Classic Noodles" data-image="./assets/special-classic-pizza.webp" data-shortname="Special Classic Pizza"><div class="card-info"><p class="card-title">Special Classic Pizza</p></div></div>
            
            <div class="card"><img src="./assets/chicken-pizza-L.webp?v=14.3" alt="Chicken Pizza L"><input type="checkbox" value="Chicken Pizza L (Minced chicken, Garlic, olive oil, Fresh tomato Sauce, mozzarella cheese, oregano)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/chicken-pizza-L.webp" data-shortname="Chicken Pizza L/S"><div class="card-info"><p class="card-title">Chicken Pizza L/S</p></div></div>
            
            <div class="card"><img src="./assets/pepperoni-pizza-L.webp?v=14.3" alt="Pepperoni Pizza L"><input type="checkbox" value="Pepperoni Pizza L/S (beef, ham, cheese, oregano)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/pepperoni-pizza-L.webp" data-shortname="Pepperoni Pizza L/S"><div class="card-info"><p class="card-title">Pepperoni Pizza L/S</p></div></div>
            
            <div class="card"><img src="./assets/beef-pizza-L.webp?v=14.3" alt="Beef Pizza L"><input type="checkbox" value="Beef Pizza L (minced beef, garlic sauce, fresh tomato sauce, mozzarella cheese, oregano)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/beef-pizza-L.webp" data-shortname="Beef Pizza L/S"><div class="card-info"><p class="card-title">Beef Pizza L/S</p></div></div>
            
            <div class="card"><img src="./assets/hawaiian-pizza-L.webp?v=14.3" alt="Hawaiian Pizza L"><input type="checkbox" value="Hawaiian Pizza L (beef sausage, pineapple, cheese, oregano)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/hawaiian-pizza-L.webp" data-shortname="Hawaiian Pizza L/S"><div class="card-info"><p class="card-title">Hawaiian Pizza L/S</p></div></div>
            
            <div class="card"><img src="./assets/tuna-pizza-L.webp?v=14.3" alt="Tuna Pizza L"><input type="checkbox" value="Tuna Pizza L (Minced tuna, fresh tomato sauce, Mozzarella cheese, olive oil, garlic)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/tuna-pizza-L.webp" data-shortname="Tuna Pizza L/S"><div class="card-info"><p class="card-title">Tuna Pizza L/S</p></div></div>
            
            <div class="card"><img src="./assets/margarita-pizza-L.webp?v=14.3" alt="Margarita Pizza L"><input type="checkbox" value="Margarita Pizza L (Garlic, olive oil, fresh tomato sauce, mozzarella cheese, oregano)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/margarita-pizza-L.webp" data-shortname="Margarita Pizza L/S"><div class="card-info"><p class="card-title">Margarita Pizza L/S</p></div></div>
            
            <div class="card"><img src="./assets/vegetable-pizza-L.webp?v=14.3" alt="Vegetable Pizza L"><input type="checkbox" value="Vegetable Pizza L (sauteed seasonal vegetables, garlic, olive oil, fresh tomato, sauce, paprika, mushroom, oregano)" data-price="600" data-restaurant="Classic Noodles" data-image="./assets/vegetable-pizza-L.webp" data-shortname="Vegetable Pizza L/S"><div class="card-info"><p class="card-title">Vegetable Pizza L/S</p></div></div>
            
            <!-- Classic Noodles Noodle Items -->
            <div class="card"><img src="./assets/stir-fry-chicken-noodles.webp?v=14.3" alt="Stir Fry Chicken Noodles"><input type="checkbox" value="Stir Fry Chicken Noodles (Freshly homemade noodles with marinated chicken breast(chopped) with egg/without egg, and different fresh vegetable and spice served with chili and soya sauce)" data-price="650" data-restaurant="Classic Noodles" data-image="./assets/stir-fry-chicken-noodles.webp" data-shortname="Stir Fry Chicken Noodles"><div class="card-info"><p class="card-title">Stir Fry Chicken Noodles</p></div></div>
            
            <div class="card"><img src="./assets/stir-fry-beef-noodles.webp?v=14.3" alt="Stir Fry Beef Noodles"><input type="checkbox" value="Stir Fry Beef Noodles (freshly homemade noodles marinated beef(chopped)with egg/without egg and different fresh vegetable and spice served with chili and soya sauce)" data-price="630" data-restaurant="Classic Noodles" data-image="./assets/stir-fry-beef-noodles.webp" data-shortname="Stir Fry Beef Noodles"><div class="card-info"><p class="card-title">Stir Fry Beef Noodles</p></div></div>
            
            <div class="card"><img src="./assets/stir-fry-vegetable-noodles.webp?v=14.3" alt="Stir Fry Vegetable Noodles"><input type="checkbox" value="Stir Fry Vegetable Noodles (Fasting) Freshly homemade noodles different vegetable, with egg/without egg, different fresh vegetable and spice served with chili and soya sauce" data-price="550" data-restaurant="Classic Noodles" data-image="./assets/stir-fry-vegetable-noodles.webp" data-shortname="Stir Fry Vegetable Noodles"><div class="card-info"><p class="card-title">Stir Fry Vegetable Noodles</p></div></div>
            
            <div class="card"><img src="./assets/stir-fry-fish-noodles.webp?v=14.3" alt="Stir Fry Fish Noodles"><input type="checkbox" value="Stir Fry Fish Noodles (freshly homemade noodles with marinated fish with egg or without egg and different fresh vegetable and spice served with chili and soya sauce)" data-price="610" data-restaurant="Classic Noodles" data-image="./assets/stir-fry-fish-noodles.webp" data-shortname="Stir Fry Fish Noodles"><div class="card-info"><p class="card-title">Stir Fry Fish Noodles</p></div></div>
        </div>

        <!-- ETALEM HOTEL RESTAURANT -->
        <div class="res-title">
            <i class="fas fa-hotel"></i>
            <span data-am="እታለም ኢንተርናሽናል ሆቴል" data-om="Etalem Interneeshinaal Hoteela">እታለም ኢንተርናሽናል ሆቴል</span>
        </div>
        <div class="menu-grid" data-restaurant="Etalem Hotel">
            <!-- Etalem Burger Items -->
            <div class="card"><img src="./assets/double-special-burger.webp?v=14.3" alt="Double Special Burger"><input type="checkbox" value="Double Special Burger" data-price="700" data-restaurant="Etalem Hotel" data-image="./assets/double-special-burger.webp" data-shortname="Double Special Burger"><div class="card-info"><p class="card-title">Double Special Burger</p></div></div>
            <div class="card"><img src="./assets/special-burger.webp?v=14.3" alt="Special Burger"><input type="checkbox" value="Special Burger" data-price="500" data-restaurant="Etalem Hotel" data-image="./assets/special-burger.webp" data-shortname="Special Burger"><div class="card-info"><p class="card-title">Special Burger</p></div></div>
            <div class="card"><img src="./assets/double-beef-burger.webp?v=14.3" alt="Double Beef Burger"><input type="checkbox" value="Double Beef Burger" data-price="480" data-restaurant="Etalem Hotel" data-image="./assets/double-beef-burger.webp" data-shortname="Double Beef Burger"><div class="card-info"><p class="card-title">Double Beef Burger</p></div></div>
            <div class="card"><img src="./assets/cheese-burger.webp?v=14.3" alt="Cheese Burger"><input type="checkbox" value="Cheese Burger" data-price="450" data-restaurant="Etalem Hotel" data-image="./assets/cheese-burger.webp" data-shortname="Cheese Burger"><div class="card-info"><p class="card-title">Cheese Burger</p></div></div>
            <div class="card"><img src="./assets/normal-burger.webp?v=14.3" alt="Normal Burger"><input type="checkbox" value="Normal Burger" data-price="410" data-restaurant="Etalem Hotel" data-image="./assets/normal-burger.webp" data-shortname="Normal Burger"><div class="card-info"><p class="card-title">Normal Burger</p></div></div>
            <div class="card"><img src="./assets/tuna-burger.webp?v=14.3" alt="Tuna Burger"><input type="checkbox" value="Tuna Burger" data-price="350" data-restaurant="Etalem Hotel" data-image="./assets/tuna-burger.webp" data-shortname="Tuna Burger"><div class="card-info"><p class="card-title">Tuna Burger</p></div></div>
            <div class="card"><img src="./assets/vegetable-burger.webp?v=14.3" alt="Vegetable Burger"><input type="checkbox" value="Vegetable Burger" data-price="250" data-restaurant="Etalem Hotel" data-image="./assets/vegetable-burger.webp" data-shortname="Vegetable Burger"><div class="card-info"><p class="card-title">Vegetable Burger</p></div></div>
            <div class="card"><img src="./assets/sandwich-club.webp?v=14.3" alt="Sandwich Club"><input type="checkbox" value="Sandwich Club" data-price="400" data-restaurant="Etalem Hotel" data-image="./assets/sandwich-club.webp" data-shortname="Sandwich Club"><div class="card-info"><p class="card-title">Sandwich Club</p></div></div>
            
            <!-- Etalem Chips -->
            <div class="card"><img src="./assets/chips.webp?v=14.3" alt="Chips"><input type="checkbox" value="Chips (ቺፕስ)" data-price="250" data-restaurant="Etalem Hotel" data-image="./assets/chips.webp" data-shortname="Chips"><div class="card-info"><p class="card-title">Chips (ቺፕስ)</p></div></div>
            
            <!-- Etalem Pizza Items -->
            <div class="card"><img src="./assets/etalem-special-pizza.webp?v=14.3" alt="Etalem Special Pizza"><input type="checkbox" value="Etalem Special Pizza" data-price="650" data-restaurant="Etalem Hotel" data-image="./assets/etalem-special-pizza.webp" data-shortname="Etalem Special Pizza"><div class="card-info"><p class="card-title">Etalem Special Pizza</p></div></div>
            <div class="card"><img src="./assets/beef-pizza.webp?v=14.3" alt="Beef Pizza"><input type="checkbox" value="Beef Pizza" data-price="600" data-restaurant="Etalem Hotel" data-image="./assets/beef-pizza.webp" data-shortname="Beef Pizza"><div class="card-info"><p class="card-title">Beef Pizza</p></div></div>
            <div class="card"><img src="./assets/margaritta-pizza.webp?v=14.3" alt="Margaritta Pizza"><input type="checkbox" value="Margaritta Pizza" data-price="650" data-restaurant="Etalem Hotel" data-image="./assets/margaritta-pizza.webp" data-shortname="Margaritta Pizza"><div class="card-info"><p class="card-title">Margaritta Pizza</p></div></div>
            <div class="card"><img src="./assets/chicken-pizza.webp?v=14.3" alt="Chicken Pizza"><input type="checkbox" value="Chicken Pizza" data-price="700" data-restaurant="Etalem Hotel" data-image="./assets/chicken-pizza.webp" data-shortname="Chicken Pizza"><div class="card-info"><p class="card-title">Chicken Pizza</p></div></div>
            <div class="card"><img src="./assets/tuna-pizza.webp?v=14.3" alt="Tuna Pizza"><input type="checkbox" value="Tuna Pizza" data-price="550" data-restaurant="Etalem Hotel" data-image="./assets/tuna-pizza.webp" data-shortname="Tuna Pizza"><div class="card-info"><p class="card-title">Tuna Pizza</p></div></div>
            <div class="card"><img src="./assets/vegetable-pizza.webp?v=14.3" alt="Vegetable Pizza"><input type="checkbox" value="Vegetable Pizza" data-price="350" data-restaurant="Etalem Hotel" data-image="./assets/vegetable-pizza.webp" data-shortname="Vegetable Pizza"><div class="card-info"><p class="card-title">Vegetable Pizza</p></div></div>
            
            <!-- Etalem Juice Items -->
            <div class="card"><img src="./assets/etalem-special-juice.webp?v=14.3" alt="Etalem Special Juice"><input type="checkbox" value="Etalem Special Juice" data-price="200" data-restaurant="Etalem Hotel" data-image="./assets/etalem-special-juice.webp" data-shortname="Etalem Special Juice"><div class="card-info"><p class="card-title">Etalem Special Juice</p></div></div>
            <div class="card"><img src="./assets/strawberry-juice.webp?v=14.3" alt="Strawberry Juice"><input type="checkbox" value="Strawberry Juice" data-price="250" data-restaurant="Etalem Hotel" data-image="./assets/strawberry-juice.webp" data-shortname="Strawberry Juice"><div class="card-info"><p class="card-title">Strawberry Juice</p></div></div>
            <div class="card"><img src="./assets/mixed-juice.webp?v=14.3" alt="Mixed Juice"><input type="checkbox" value="Mixed Juice" data-price="200" data-restaurant="Etalem Hotel" data-image="./assets/mixed-juice.webp" data-shortname="Mixed Juice"><div class="card-info"><p class="card-title">Mixed Juice</p></div></div>
            
            <!-- Etalem Fish Items -->
            <div class="card"><img src="./assets/fish-kotelet.webp?v=14.3" alt="Fish Kotelet"><input type="checkbox" value="Fish Kotelet" data-price="400" data-restaurant="Etalem Hotel" data-image="./assets/fish-kotelet.webp" data-shortname="Fish Kotelet"><div class="card-info"><p class="card-title">Fish Kotelet</p></div></div>
            <div class="card"><img src="./assets/grilled-fish.webp?v=14.3" alt="Grilled Fish"><input type="checkbox" value="Grilled Fish" data-price="400" data-restaurant="Etalem Hotel" data-image="./assets/grilled-fish.webp" data-shortname="Grilled Fish"><div class="card-info"><p class="card-title">Grilled Fish</p></div></div>
        </div>

        <!-- KAMETI KITCHEN RESTAURANT -->
        <div class="res-title">
            <i class="fas fa-utensil-spoon"></i>
            <span data-am="ካሜቲ (Kameti's Kitchen)" data-om="Kameetii (Kameti's Kitchen)">ካሜቲ (Kameti's Kitchen)</span>
        </div>
        <div class="menu-grid" data-restaurant="Kameti Kitchen">
            <!-- Kameti Burger Items -->
            <div class="card"><img src="./assets/kameti-special-burger.webp?v=14.3" alt="Kameti Special Burger"><input type="checkbox" value="Kameti Special Burger" data-price="500" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-special-burger.webp" data-shortname="Special Burger"><div class="card-info"><p class="card-title">Special Burger</p></div></div>
            <div class="card"><img src="./assets/kameti-cheese-burger.webp?v=14.3" alt="Kameti Cheese Burger"><input type="checkbox" value="Kameti Cheese Burger" data-price="480" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-cheese-burger.webp" data-shortname="Cheese Burger"><div class="card-info"><p class="card-title">Cheese Burger</p></div></div>
            <div class="card"><img src="./assets/kameti-beef-burger.webp?v=14.3" alt="Kameti Beef Burger"><input type="checkbox" value="Kameti Beef Burger" data-price="450" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-beef-burger.webp" data-shortname="Beef Burger"><div class="card-info"><p class="card-title">Beef Burger</p></div></div>
            
            <!-- Kameti Pizza Items -->
            <div class="card"><img src="./assets/kameti-large-pizza.webp?v=14.3" alt="Kameti Large Pizza"><input type="checkbox" value="Kameti Large Pizza" data-price="700" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-large-pizza.webp" data-shortname="Large Pizza"><div class="card-info"><p class="card-title">Large Pizza</p></div></div>
            <div class="card"><img src="./assets/kameti-medium-pizza.webp?v=14.3" alt="Kameti Medium Pizza"><input type="checkbox" value="Kameti Medium Pizza" data-price="600" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-medium-pizza.webp" data-shortname="Medium Pizza"><div class="card-info"><p class="card-title">Medium Pizza</p></div></div>
            <div class="card"><img src="./assets/kameti-tuna-pizza.webp?v=14.3" alt="Kameti Tuna Pizza"><input type="checkbox" value="Kameti Tuna Pizza" data-price="480" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-tuna-pizza.webp" data-shortname="Tuna Pizza"><div class="card-info"><p class="card-title">Tuna Pizza</p></div></div>
            
            <!-- Kameti Juice -->
            <div class="card"><img src="./assets/kameti-special-juice.webp?v=14.3" alt="Kameti Special Juice"><input type="checkbox" value="Kameti Special Juice" data-price="230" data-restaurant="Kameti Kitchen" data-image="./assets/kameti-special-juice.webp" data-shortname="Special Juice"><div class="card-info"><p class="card-title">Special Juice</p></div></div>
            
            <!-- Kameti Chips (150 ETB) -->
            <div class="card"><img src="./assets/chips.webp?v=14.3" alt="Kameti's Chips"><input type="checkbox" value="Kameti's Chips" data-price="150" data-restaurant="Kameti Kitchen" data-image="./assets/chips.webp" data-shortname="Kameti's Chips"><div class="card-info"><p class="card-title">Kameti's Chips</p></div></div>
        </div>
    </div>
</div>

<!-- ABOUT PAGE -->
<div id="aboutPage" class="page-content">
    <header>
        <h1 style="margin:0; color:var(--dark); font-size: 1.8rem;" data-am="ስለ ቢሾፍቱ ዴሊቨሪ" data-om="Waa'ee Bishooftu Ergaa">ስለ ቢሾፍቱ ዴሊቨሪ</h1>
        <div style="font-size: 0.8rem; color: var(--text-light);" data-am="እንዴት እንደምንሰራ" data-om="Akkam nuti hojjennu">እንዴት እንደምንሰራ</div>
    </header>

    <div class="container">
        <!-- Operating Hours Banner -->
        <div class="hours-banner">
            <i class="fas fa-clock"></i>
            <span data-am="የስራ ሰዓት: 9:00 AM - 6:00 PM" data-om="Yeroo Hojii: 9:00 AM - 6:00 PM">የስራ ሰዓት: 9:00 AM - 6:00 PM</span>
        </div>

        <div class="info-card">
            <h2 data-am="እንዴት እንሰራለን" data-om="Akkam Nuti Hojjennu">እንዴት እንሰራለን</h2>
            
            <div class="step-card">
                <div class="step-number">1</div>
                <div>
                    <h3 style="margin:0;" data-am="ምግብ ይምረጡ" data-om="Nyaata Filadhu">ምግብ ይምረጡ</h3>
                    <p data-am="ከClassic Noodles, እታለም ሆቴል ወይም ካሜቲ ኪችን የተሻለ ምግብ ይምረጡ" data-om="Classic Noodles, Etalem Hoteela ykn Kameetii Kitchen irraa nyaata filadhu">ከClassic Noodles, እታለም ሆቴል ወይም ካሜቲ ኪችን የተሻለ ምግብ ይምረጡ</p>
                </div>
            </div>
            
            <div class="step-card">
                <div class="step-number">2</div>
                <div>
                    <h3 style="margin:0;" data-am="መረጃ ያስገቡ" data-om="Odeeffannoo Galchi">መረጃ ያስገቡ</h3>
                    <p data-am="አካባቢዎን ያሳውቁ (ለፈጣን ማድረሻ እና የመላኪያ ክፍያ ለማስላት)" data-om="Bakka keessan agarsiisaa (ariifachiifachuuf fi kaffaltii ergaa hiruuf)">አካባቢዎን ያሳውቁ (ለፈጣን ማድረሻ እና የመላኪያ ክፍያ ለማስላት)</p>
                </div>
            </div>
            
            <div class="step-card">
                <div class="step-number">3</div>
                <div>
                    <h3 style="margin:0;" data-am="በቴሌግራም ይላኩ" data-om="Telegiraamiin Ergi">በቴሌግራም ይላኩ</h3>
                    <p data-am="ትዕዛዝዎ በቴሌግራም በራስ-ሰር ወደ አስተዳዳሪዎቻችን ይላካል" data-om="Ordeeraa keessan Telegiraamiin ofii ofii hoggantota keenya bira geessa">ትዕዛዝዎ በቴሌግራም በራስ-ሰር ወደ አስተዳዳሪዎቻችን ይላካል</p>
                </div>
            </div>
            
            <div class="step-card">
                <div class="step-number">4</div>
                <div>
                    <h3 style="margin:0;" data-am="ምግብዎን ተቀበሉ" data-om="Nyaata Keessan Fudhadhaa">ምግብዎን ተቀበሉ</h3>
                    <p data-am="በ30-45 ደቂቃ ውስጥ ምግብዎ ይደርስዎታል። በቴሌግራም የመላኪያ ሁኔታን ይከታተሉ" data-om="Daqiiqaa 30-45 keessatti nyaata keessan siniif ga'a. Telegiraamiin ergaa hordofaa">በ30-45 ደቂቃ ውስጥ ምግብዎ ይደርስዎታል። በቴሌግራም የመላኪያ ሁኔታን ይከታተሉ</p>
                </div>
            </div>
        </div>

        <div class="info-card">
            <h2 data-am="የመላኪያ መረጃ" data-om="Odeeffannoo Ergaa">የመላኪያ መረጃ</h2>
            <ul style="padding-left:20px;">
                <li data-am="የመጀመሪያ ማድረሻ ነፃ!" data-om="Ergaa jalqabaa bilisaa!">የመጀመሪያ ማድረሻ ነፃ!</li>
                <li data-am="አሁን እዘዝ: 1 ኪ.ሜ ውስጥ 50 ብር, ከ1 ኪ.ሜ በላይ 99 ብር" data-om="Amma Ajaji: Kilomeetira 1 keessatti 50 Birraa, Kilomeetira 1 ol 99 Birraa">አሁን እዘዝ: 1 ኪ.ሜ ውስጥ 50 ብር, ከ1 ኪ.ሜ በላይ 99 ብር</li>
                <li data-am="ቅድመ ትዕዛዝ: 50 ብር" data-om="Ordeer Duraa: 50 Birraa">ቅድመ ትዕዛዝ: 50 ብር</li>
                <li data-am="የማድረሻ ጊዜ: 30-45 ደቂቃ" data-om="Yeroo Ga'umsaa: 30-45 Daqiiqaa">የማድረሻ ጊዜ: 30-45 ደቂቃ</li>
                <li data-am="አገልግሎት አካባቢ: ቢሾፍቱ ውስጥ (ከ10 ኪ.ሜ በታች)" data-om="Bakka Tajaajilaa: Bishooftu Keessaa (Kilomeetira 10 gadii)">አገልግሎት አካባቢ: ቢሾፍቱ ውስጥ (ከ10 ኪ.ሜ በታች)</li>
                <li data-am="የሚሰራው: በየቀኑ 9:00 AM - 6:00 PM" data-om="Yeroo Hojii: Guyyaa guyyaan 9:00 AM - 6:00 PM">የሚሰራው: በየቀኑ 9:00 AM - 6:00 PM</li>
            </ul>
        </div>

        <div class="info-card">
            <h2 data-am="የግላዊነት ፖሊሲ" data-om="Iccitii Qulqullinaa">የግላዊነት ፖሊሲ</h2>
            <p data-am="የእርስዎን መረጃ ለሶስተኛ ወገን አንሰጥም። ትዕዛዝዎ በቴሌግራም ለአስተዳዳሪዎቻችን ብቻ ይላካል።" data-om="Odeeffannoo keessan dursaa sadaffaa hin kenninu. Ordeeraa keessan Telegiraamiin hoggantota keenya qofa geessa.">የእርስዎን መረጃ ለሶስተኛ ወገን አንሰጥም። ትዕዛዝዎ በቴሌግራም ለአስተዳዳሪዎቻችን ብቻ ይላካል።</p>
            <p data-am="ክፍያዎች በቀጥታ በገንዘብ ይከናወናሉ።" data-om="Kaffaltiin qarshii qofa hojietama.">ክፍያዎች በቀጥታ በገንዘብ ይከናወናሉ።</p>
        </div>
    </div>
</div>

<!-- CONTACT PAGE -->
<div id="contactPage" class="page-content">
    <header>
        <h1 style="margin:0; color:var(--dark); font-size: 1.8rem;" data-am="አግኙን" data-om="Nu Qunnamuu">አግኙን</h1>
        <div style="font-size: 0.8rem; color: var(--text-light);" data-am="ከእኛ ጋር ያገናኙ" data-om="Nu Waliin Walqunnamuu">ከእኛ ጋር ያገናኙ</div>
    </header>

    <div class="container">
        <!-- Operating Hours Banner -->
        <div class="hours-banner">
            <i class="fas fa-clock"></i>
            <span data-am="የስራ ሰዓት: 9:00 AM - 6:00 PM" data-om="Yeroo Hojii: 9:00 AM - 6:00 PM">የስራ ሰዓት: 9:00 AM - 6:00 PM</span>
        </div>

        <div class="contact-card">
            <h2 data-am="ቀጥታ ማነጋገሪያ" data-om="Walqunnamtii Gaggaarii">ቀጥታ ማነጋገሪያ</h2>
            <p><strong data-am="ስልክ፡" data-om="Bilbila:">ስልክ፡</strong> 0962636940</p>
            <p><strong data-am="የስራ ሰዓት፡" data-om="Yeroo Hojii:">የስራ ሰዓት፡</strong> 9:00 AM - 6:00 PM</p>
            
            <button class="btn" onclick="callSupport()" style="margin-top:15px;" data-am="ይደውሉ" data-om="Bilbilaa">
                <i class="fas fa-phone"></i>
                <span>ይደውሉ</span>
            </button>
        </div>

        <div class="contact-card">
            <h2 data-am="ቴሌግራም" data-om="Telegiraamii">ቴሌግራም</h2>
            <p data-am="ለፈጣን ድጋፍ እና የትዕዛዝ መከታተል በቴሌግራም ይጠይቁን።" data-om="Gargaarsa ariifachiisaafi hordoffii ordeeraa Telegiraamiin nu gaafadhaa.">ለፈጣን ድጋፍ እና የትዕዛዝ መከታተል በቴሌግራም ይጠይቁን።</p>
            
            <button class="telegram-track-btn" onclick="openTelegramForSupport()">
                <i class="fab fa-telegram"></i>
                <span data-am="በቴሌግራም ይጠይቁን" data-om="Telegiraamiin Nu Gaafadhaa">በቴሌግራም ይጠይቁን</span>
            </button>
            
            <p style="font-size:0.85rem; color:var(--text-light); margin-top:10px;" data-am="አስተዳዳሪዎች በቴሌግራም በቀጥታ ይመልሳሉ" data-om="Hoggantotni Telegiraamii irratti gaaffii deebisu">አስተዳዳሪዎች በቴሌግራም በቀጥታ ይመልሳሉ</p>
        </div>

        <div class="contact-card">
            <h2 data-am="አድራሻ" data-om="Teessoo">አድራሻ</h2>
            <p data-am="ቢሾፍቱ፣ ኢትዮጵያ" data-om="Bishooftu, Itoophiyaa">ቢሾፍቱ፣ ኢትዮጵያ</p>
            <p><strong data-am="አገልግሎት አካባቢ፡" data-om="Bakka Tajaajilaa:">አገልግሎት አካባቢ፡</strong> <span data-am="ቢሾፍቱ ውስጥ (ከ10 ኪ.ሜ በታች)" data-om="Bishooftu Keessaa (Kilomeetira 10 gadii)">ቢሾፍቱ ውስጥ (ከ10 ኪ.ሜ በታች)</span></p>
        </div>

        <div class="info-card">
            <h2 data-am="ተደጋግሞ የሚጠየቁ ጥያቄዎች" data-om="Gaaffilee Kan Irra Deddeebi'an">ተደጋግሞ የሚጠየቁ ጥያቄዎች</h2>
            
            <div style="margin-bottom:15px;">
                <h4 style="margin:0;" data-am="Q: ክፍያውን እንዴት እንደሚፈጽሙ?" data-om="Q: Kaffaltiin akkamitti dabarfamuu danda'a?">Q: ክፍያውን እንዴት እንደሚፈጽሙ?</h4>
                <p data-am="A: ክፍያውን በገንዘብ ከመላኪያ በኋላ መፈጸም ይችላሉ። ዝርዝር መረጃ በቴሌግራም ይሰጥዎታል።" data-om="A: Kaffaltiin qarshii ergaa booda danda'ama. Odeeffannoo guutuu Telegiraamiin kenname.">A: ክፍያውን በገንዘብ ከመላኪያ በኋላ መፈጸም ይችላሉ። ዝርዝር መረጃ በቴሌግራም ይሰጥዎታል።</p>
            </div>
            
            <div style="margin-bottom:15px;">
                <h4 style="margin:0;" data-am="Q: ምግቡ ምን ያህል ጊዜ ይፈጅብታል?" data-om="Q: Nyaataan yeroon meeqaatti ga'a?">Q: ምግቡ ምን ያህል ጊዜ ይፈጅብታል?</h4>
                <p data-am="A: በ30-45 ደቂቃ ውስጥ። በቴሌግራም መላኪያውን ማየት ይችላሉ።" data-om="A: Daqiiqaa 30-45 keessatti. Telegiraamiin ergaa arguudha.">A: በ30-45 ደቂቃ ውስጥ። በቴሌግራም መላኪያውን ማየት ይችላሉ።</p>
            </div>
            
            <div>
                <h4 style="margin:0;" data-am="Q: ትዕዛዜን እንዴት እከታተላለሁ?" data-om="Q: Ordeeraa kiyya akkamitti hordoftu?">Q: ትዕዛዜን እንዴት እከታተላለሁ?</h4>
                <p data-am="A: በዚህ አፕ ውስጥ ትዕዛዝ ፈልግ ይባላል ወይም በቴሌግራም ከአስተዳዳሪዎቻችን ጋር ተገናኝ።" data-om="A: App kana keessatti 'Ordeer Barbaadi' cuqi ykn Telegiraamiin hoggantota keenya waliin walqunnami.">A: በዚህ አፕ ውስጥ ትዕዛዝ ፈልግ ይባላል ወይም በቴሌግራም ከአስተዳዳሪዎቻችን ጋር ተገናኝ።</p>
            </div>
        </div>
    </div>
</div>

<div class="floating-footer">
    <button class="btn" onclick="openCheckout()" id="checkout-btn" data-am="ትዕዛዝ አጠናቅ" data-om="Dhaadannoo Xumuri">
        <i class="fas fa-shopping-cart"></i>
        <span id="cartCount">0</span>
        <span>ትዕዛዝ አጠናቅ</span>
    </button>
</div>

<script>
    // PWA Installation Handler
let deferredPrompt = null;
const installButton = document.getElementById('installButton');

// Listen for beforeinstallprompt event
window.addEventListener('beforeinstallprompt', (e) => {
  console.log('PWA: beforeinstallprompt event fired');
  
  // Prevent Chrome 67+ from automatically showing prompt
  e.preventDefault();
  
  // Stash the event
  deferredPrompt = e;
  
  // Show install button if it exists
  if (installButton) {
    installButton.style.display = 'flex';
  }
  
  // Show PWA popup after 3 seconds
  setTimeout(() => {
    showPWApopup();
  }, 3000);
});

// Listen for app installed event
window.addEventListener('appinstalled', (evt) => {
  console.log('PWA: App was installed');
  localStorage.setItem('pwaInstalled', 'true');
  
  // Hide install buttons
  if (installButton) installButton.style.display = 'none';
  hidePWApopup();
  
  // Show success message
  showToast(currentLang === 'am' ? 'አፕዎ ተጫኗል!' : 'App keessan sirreessame!', 3000);
});

// Check if PWA is installable
function checkPWAInstallable() {
  const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
  const isInstalled = localStorage.getItem('pwaInstalled') === 'true';
  
  if (isStandalone || isInstalled) {
    return false;
  }
  
  return deferredPrompt !== null;
}

// Show PWA popup
function showPWApopup() {
  const isInstallable = checkPWAInstallable();
  const isDismissed = localStorage.getItem('pwaPopupDismissed') === 'true';
  
  if (!isInstallable || isDismissed) return;
  
  document.getElementById('pwaPopup').style.display = 'block';
}

// Install PWA function
function installPWA() {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    
    deferredPrompt.userChoice.then((choiceResult) => {
      if (choiceResult.outcome === 'accepted') {
        console.log('User accepted PWA installation');
        localStorage.setItem('pwaInstalled', 'true');
        hidePWApopup();
        if (installButton) installButton.style.display = 'none';
      }
      deferredPrompt = null;
    });
  } else {
    // Fallback instructions
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    const isAndroid = /Android/.test(navigator.userAgent);
    
    let message = '';
    if (isIOS) {
      message = '1. Tap Share button\n2. Tap "Add to Home Screen"\n3. Tap "Add"';
    } else if (isAndroid) {
      message = '1. Tap Menu (3 dots)\n2. Tap "Install app" or "Add to Home Screen"\n3. Tap "Install"';
    } else {
      message = 'Look for the install icon in your browser address bar';
    }
    
    alert(currentLang === 'am' ? 
      'አፕ ለመጫን:\n\n' + message : 
      'To install app:\n\n' + message);
  }
}

// Dismiss PWA popup
function dismissPWA() {
  hidePWApopup();
  localStorage.setItem('pwaPopupDismissed', 'true');
}

function hidePWApopup() {
  document.getElementById('pwaPopup').style.display = 'none';
}
    // Restaurant coordinates with correct values
    const RESTAURANT_COORDINATES = {
        'Classic Noodles': { lat: 8.7512517, lng: 38.9619680 },
        'Etalem Hotel': { lat: 8.7592026, lng: 38.9458399 },
        'Kameti Kitchen': { lat: 8.7596178, lng: 38.9450543 }
    };
    
    const MAX_DELIVERY_DISTANCE = 10; // 10km maximum
    
    const BOT_USERNAME = "Bishoftu_Delivery_bot";
    const TELEGRAM_ADMIN_USERNAME = "Bishoftu_Delivery_bot";
    let orderData = {};
    let userLat = null;
    let userLng = null;
    let userPhone = '';
    let deferredPrompt = null;
    const FIRST_DELIVERY_FREE = true;
    let isFirstOrder = localStorage.getItem('firstOrderMade') !== 'true';
    const SITE_URL = "https://bishoftudelivery.github.io/";
    let currentLang = localStorage.getItem('preferredLang') || 'am';
    let currentPage = 'home';
    let selectedPaymentMethod = 'cash'; // Default to cash payment after delivery
    let deliveryFee = 0;
    let calculatedDistance = 0;
    let isLocationRequested = false;
    let orderType = 'normal'; // 'normal', 'preorder', or 'group'
    let preorderTimeSlot = ''; // 'slot1', 'slot2', 'slot3'
    
    // Recent orders storage - IMPROVED: Store actual food items with images
    let recentOrders = JSON.parse(localStorage.getItem('recentOrders')) || [];
    
    // Menu items mapping for images (simplified for recent orders)
    const menuItemsMap = {
        // Classic Noodles Items
        'Classic King Burger': './assets/classic-king-burger.webp',
        'Classic Chicken Burger': './assets/classic-chicken-burger.webp',
        'Double Cheese Burger': './assets/double-cheese-burger.webp',
        'Classic Burger': './assets/classic-burger.webp',
        'Beef Burger': './assets/beef-burger-new.webp',
        'Cheese Burger': './assets/cheese-burger-new.webp',
        'Hamburger': './assets/hamburger-new.webp',
        'Double Beef Burger': './assets/double-beef-burger-new.webp',
        'Mixed Burger': './assets/mixed-burger.webp',
        'Special Classic Pizza': './assets/special-classic-pizza.webp',
        'Chicken Pizza L/S': './assets/chicken-pizza-L.webp',
        'Pepperoni Pizza L/S': './assets/pepperoni-pizza-L.webp',
        'Beef Pizza L/S': './assets/beef-pizza-L.webp',
        'Hawaiian Pizza L/S': './assets/hawaiian-pizza-L.webp',
        'Tuna Pizza L/S': './assets/tuna-pizza-L.webp',
        'Margarita Pizza L/S': './assets/margarita-pizza-L.webp',
        'Vegetable Pizza L/S': './assets/vegetable-pizza-L.webp',
        'Stir Fry Chicken Noodles': './assets/stir-fry-chicken-noodles.webp',
        'Stir Fry Beef Noodles': './assets/stir-fry-beef-noodles.webp',
        'Stir Fry Vegetable Noodles': './assets/stir-fry-vegetable-noodles.webp',
        'Stir Fry Fish Noodles': './assets/stir-fry-fish-noodles.webp',
        
        // Etalem Hotel Items
        'Double Special Burger': './assets/double-special-burger.webp',
        'Special Burger': './assets/special-burger.webp',
        'Double Beef Burger': './assets/double-beef-burger.webp',
        'Cheese Burger': './assets/cheese-burger.webp',
        'Normal Burger': './assets/normal-burger.webp',
        'Tuna Burger': './assets/tuna-burger.webp',
        'Vegetable Burger': './assets/vegetable-burger.webp',
        'Sandwich Club': './assets/sandwich-club.webp',
        'Chips (ቺፕስ)': './assets/chips.webp',
        'Etalem Special Pizza': './assets/etalem-special-pizza.webp',
        'Beef Pizza': './assets/beef-pizza.webp',
        'Margaritta Pizza': './assets/margaritta-pizza.webp',
        'Chicken Pizza': './assets/chicken-pizza.webp',
        'Tuna Pizza': './assets/tuna-pizza.webp',
        'Vegetable Pizza': './assets/vegetable-pizza.webp',
        'Etalem Special Juice': './assets/etalem-special-juice.webp',
        'Strawberry Juice': './assets/strawberry-juice.webp',
        'Mixed Juice': './assets/mixed-juice.webp',
        'Fish Kotelet': './assets/fish-kotelet.webp',
        'Grilled Fish': './assets/grilled-fish.webp',
        
        // Kameti Kitchen Items
        'Kameti Special Burger': './assets/kameti-special-burger.webp',
        'Kameti Cheese Burger': './assets/kameti-cheese-burger.webp',
        'Kameti Beef Burger': './assets/kameti-beef-burger.webp',
        'Kameti Large Pizza': './assets/kameti-large-pizza.webp',
        'Kameti Medium Pizza': './assets/kameti-medium-pizza.webp',
        'Kameti Tuna Pizza': './assets/kameti-tuna-pizza.webp',
        'Kameti Special Juice': './assets/kameti-special-juice.webp',
        'Kameti\'s Chips': './assets/chips.webp'
    };
    
    // Pull to refresh variables
    let startY = 0;
    let currentY = 0;
    let isRefreshing = false;
    const refreshContainer = document.getElementById('refreshContainer');
    const refreshSpinner = document.getElementById('refreshSpinner');
    const refreshText = document.getElementById('refreshText');

    // Elements
    const offlineIndicator = document.getElementById('offlineIndicator');
    const toast = document.getElementById('toast');
    const installButton = document.getElementById('installButton');

    // Initialize recent orders - IMPROVED: Shows actual food items with images
    function initRecentOrders() {
        const recentContainer = document.getElementById('recentItems');
        const noRecentOrders = document.getElementById('noRecentOrders');
        
        if (recentOrders.length === 0) {
            noRecentOrders.style.display = 'flex';
            return;
        }
        
        noRecentOrders.style.display = 'none';
        recentContainer.innerHTML = '';
        
        // Show only the last 3 orders
        const lastThreeOrders = recentOrders.slice(-3).reverse();
        
        lastThreeOrders.forEach((order, index) => {
            const recentItem = document.createElement('div');
            recentItem.className = 'recent-item';
            recentItem.onclick = () => addRecentItem(order.name, order.shortname);
            
            const itemName = order.shortname || order.name;
            const imageSrc = order.image || menuItemsMap[itemName] || './assets/double-special-burger.webp';
            
            recentItem.innerHTML = `
                <img src="${imageSrc}" alt="${itemName}" class="recent-image" onerror="this.src='./assets/double-special-burger.webp'">
                <div class="recent-name">${itemName}</div>
            `;
            recentContainer.appendChild(recentItem);
        });
        
        // If less than 3 items, add placeholders
        if (lastThreeOrders.length < 3) {
            for (let i = lastThreeOrders.length; i < 3; i++) {
                const placeholder = document.createElement('div');
                placeholder.className = 'recent-item';
                placeholder.style.opacity = '0.5';
                placeholder.innerHTML = `
                    <div style="width: 70px; height: 70px; border-radius: 50%; background: #f0f0f0; margin-bottom: 8px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-utensils" style="color: #ccc; font-size: 1.5rem;"></i>
                    </div>
                    <div class="recent-name" style="color: #ccc;">---</div>
                `;
                recentContainer.appendChild(placeholder);
            }
        }
    }
    
    // Add recent item to cart - IMPROVED: Finds exact matches
    function addRecentItem(itemName, shortname) {
        // Find the checkbox for this item using shortname if available
        const searchName = shortname || itemName;
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        
        // First try exact match with shortname
        for (let checkbox of checkboxes) {
            const checkboxShortname = checkbox.getAttribute('data-shortname');
            if (checkboxShortname === searchName) {
                checkbox.checked = true;
                
                // Animate the card
                const card = checkbox.closest('.card');
                card.classList.add('item-added');
                setTimeout(() => {
                    card.classList.remove('item-added');
                }, 300);
                
                updateCartCount();
                showToast(`${currentLang === 'am' ? 'ተጨመረ:' : 'Dabalame:'} ${searchName}`, 2000);
                return;
            }
        }
        
        // If exact match not found, try partial match with full name
        for (let checkbox of checkboxes) {
            const checkboxValue = checkbox.value;
            const checkboxName = checkboxValue.split('(')[0].trim();
            if (checkboxName.toLowerCase().includes(searchName.toLowerCase())) {
                checkbox.checked = true;
                
                const card = checkbox.closest('.card');
                card.classList.add('item-added');
                setTimeout(() => {
                    card.classList.remove('item-added');
                }, 300);
                
                updateCartCount();
                showToast(`${currentLang === 'am' ? 'ተጨመረ:' : 'Dabalame:'} ${searchName}`, 2000);
                return;
            }
        }
        
        // If not found, show message
        showToast(currentLang === 'am' ? 'አትሙ በምናሌው ውስጥ አልተገኘም' : 'Nyaanni menu keessatti hin argamne', 3000);
    }
    
    // Add order to recent orders - IMPROVED: Stores actual food items with images
    function addToRecentOrders(orderItems) {
        // Extract individual items from order
        const items = orderItems.split(', ');
        
        items.forEach(item => {
            const itemName = item.split('(')[0].trim();
            
            // Find the checkbox for this item to get image and shortname
            let imageSrc = '';
            let shortname = '';
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                const checkboxValue = checkbox.value;
                if (checkboxValue.startsWith(itemName)) {
                    imageSrc = checkbox.getAttribute('data-image') || '';
                    shortname = checkbox.getAttribute('data-shortname') || itemName;
                }
            });
            
            // Check if item already exists in recent orders
            const exists = recentOrders.some(order => order.name === itemName);
            
            if (!exists) {
                recentOrders.push({
                    name: itemName,
                    shortname: shortname,
                    image: imageSrc,
                    date: new Date().toISOString()
                });
                
                // Keep only last 10 orders
                if (recentOrders.length > 10) {
                    recentOrders = recentOrders.slice(-10);
                }
            }
        });
        
        // Save to localStorage
        localStorage.setItem('recentOrders', JSON.stringify(recentOrders));
        
        // Update UI
        initRecentOrders();
    }

    // Language switching function
    function switchLanguage(lang) {
        currentLang = lang;
        localStorage.setItem('preferredLang', lang);
        
        // Update HTML lang attribute and data-lang
        document.documentElement.lang = lang;
        document.documentElement.setAttribute('data-lang', lang);
        
        // Update button states
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
            if (btn.textContent === (lang === 'am' ? 'አማርኛ' : 'Afaan Oromoo')) {
                btn.classList.add('active');
            }
        });
        
        // Update all translatable elements
        updateTextContent();
        
        // Update recent orders with new language
        initRecentOrders();
        
        // Update cart count
        updateCartCount();
        
        // Show confirmation
        showToast(lang === 'am' ? 'ቋንቋ ተቀይሯል!' : 'Afaan jijjiirame!', 2000);
    }

    // Update text content based on language
    function updateTextContent() {
        // Update elements with data attributes
        document.querySelectorAll('[data-am]').forEach(el => {
            if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                const placeholder = currentLang === 'am' ? 
                    el.getAttribute('data-am-placeholder') : 
                    el.getAttribute('data-om-placeholder');
                if (placeholder) el.placeholder = placeholder;
            } else {
                const text = currentLang === 'am' ? 
                    el.getAttribute('data-am') : 
                    el.getAttribute('data-om');
                if (text) el.innerHTML = text;
            }
        });
        
        // Update page title
        const title = currentLang === 'am' ? 
            'ቢሾፍቱ ዴሊቨሪ | Bishoftu Delivery' : 
            'Bishooftu Ergaa | Bishoftu Delivery';
        document.title = title;
        document.getElementById('page-title').textContent = title;
        
        // Update refresh text
        if (refreshText) {
            refreshText.textContent = currentLang === 'am' ? 
                'ይቀናል... ለማደስት ከላይ ይሳቡ' : 
                'Deebi\'aa... Harka keessan deebisuu fedhaa';
        }
        
        // Update fire icons
        document.querySelectorAll('.fire').forEach((fire, index) => {
            fire.textContent = index === 0 ? '🔥' : index === 1 ? '🔥' : '🔥';
        });
    }

    // Select order type
    function selectOrderType(type) {
        orderType = type;
        
        // Update UI
        document.querySelectorAll('.order-type-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        if (type === 'normal') {
            document.getElementById('normalOrderBtn').classList.add('active');
        } else if (type === 'preorder') {
            document.getElementById('preorderBtn').classList.add('active');
        }
    }

    // Select preorder time slot
    function selectPreorderTime(slot) {
        preorderTimeSlot = slot;
        
        // Update UI
        document.querySelectorAll('.time-option').forEach(option => {
            option.classList.remove('selected');
        });
        
        document.getElementById(slot + 'Option').classList.add('selected');
    }

    // Select payment method in modal
    function selectPaymentMethod(method) {
        selectedPaymentMethod = method;
        
        // Update UI
        document.querySelectorAll('.payment-option').forEach(option => {
            option.classList.remove('selected');
            option.querySelector('.fa-check-circle').style.display = 'none';
        });
        
        const selectedOption = document.getElementById(method + 'PaymentOption');
        selectedOption.classList.add('selected');
        selectedOption.querySelector('.fa-check-circle').style.display = 'block';
    }

    // Show page function
    function showPage(page) {
        currentPage = page;
        
        // Hide all pages
        document.querySelectorAll('.page-content').forEach(p => {
            p.classList.remove('active');
        });
        
        // Show selected page
        document.getElementById(page + 'Page').classList.add('active');
        
        // Update navigation buttons
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelector(`.nav-btn[onclick="showPage('${page}')"]`).classList.add('active');
        
        // Update footer button
        const checkoutBtn = document.getElementById('checkout-btn');
        if (page === 'home') {
            checkoutBtn.style.display = 'flex';
            checkoutBtn.innerHTML = `
                <i class="fas fa-shopping-cart"></i>
                <span id="cartCount">${getCartCount()}</span>
                <span>${currentLang === 'am' ? 'ትዕዛዝ አጠናቅ' : 'Dhaadannoo Xumuri'}</span>
            `;
            checkoutBtn.onclick = openCheckout;
        } else {
            checkoutBtn.style.display = 'none';
        }
        
        // Scroll to top
        window.scrollTo(0, 0);
    }

    // Update cart count
    function updateCartCount() {
        const count = getCartCount();
        document.getElementById('cartCount').textContent = count;
    }
    
    function getCartCount() {
        return document.querySelectorAll('input[type="checkbox"]:checked').length;
    }

    // Open Telegram for support
    function openTelegramForSupport() {
        const message = currentLang === 'am' ?
            'ሰላም! ከቢሾፍቱ ዴሊቨሪ እገዛ እፈልጋለሁ።' :
            'Akkam! Bishooftu Ergaa irraa gargaarsa barbaada.';
        
        const encodedMessage = encodeURIComponent(message);
        const telegramUrl = `https://t.me/${TELEGRAM_ADMIN_USERNAME}?text=${encodedMessage}`;
        window.open(telegramUrl, '_blank');
    }

    // Call support
    function callSupport() {
        window.location.href = 'tel:+251962636940';
    }

    // Contact support
    function contactSupport() {
        openTelegramForSupport();
    }

    // Initialize app
    window.onload = () => {
        // Set initial language
        switchLanguage(currentLang);
        updateStreakUI();
        initPWA();
        initPullToRefresh();
        initRecentOrders();
        
        // Update cart count
        updateCartCount();
        
        // Add event listeners to checkboxes
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', updateCartCount);
        });
        
        // Update stats with random numbers (for demo)
        setInterval(() => {
            const ordersToday = document.getElementById('ordersToday');
            const activeRiders = document.getElementById('activeRiders');
            if (ordersToday) {
                const current = parseInt(ordersToday.textContent);
                ordersToday.textContent = current + Math.floor(Math.random() * 3);
            }
            if (activeRiders) {
                activeRiders.textContent = 2 + Math.floor(Math.random() * 2);
            }
        }, 10000);
        
        // 1. Show PWA popup after 5 seconds (CHANGED FROM 10)
        setTimeout(() => {
            showPWApopup();
        }, 5000);
        
        // Check online/offline status
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
        updateOnlineStatus();
        
        // Check for updates
        checkForUpdates();
        
        // Try to get saved location
        const savedLocation = sessionStorage.getItem('userLocation');
        if (savedLocation) {
            const loc = JSON.parse(savedLocation);
            userLat = loc.lat;
            userLng = loc.lng;
            isLocationRequested = true;
        }
        
        // Set default payment method to cash (payment after delivery)
        selectPaymentMethod('cash');
        
        // Set default order type to normal
        selectOrderType('normal');
        
        // Add click event to install button
        installButton.addEventListener('click', installPWA);
    };

    // Initialize Pull to Refresh
    function initPullToRefresh() {
        document.addEventListener('touchstart', handleTouchStart, { passive: true });
        document.addEventListener('touchmove', handleTouchMove, { passive: false });
        document.addEventListener('touchend', handleTouchEnd);
    }

    function handleTouchStart(e) {
        if (window.scrollY === 0 && !isRefreshing) {
            startY = e.touches[0].clientY;
            currentY = startY;
        }
    }

    function handleTouchMove(e) {
        if (!startY || isRefreshing) return;
        
        currentY = e.touches[0].clientY;
        const deltaY = currentY - startY;
        
        if (window.scrollY === 0 && deltaY > 0) {
            e.preventDefault();
            const pullProgress = Math.min(deltaY / 100, 1);
            refreshContainer.style.top = `${Math.min(deltaY - 60, 0)}px`;
            
            // Update text based on pull distance
            if (deltaY > 80) {
                refreshText.textContent = currentLang === 'am' ? 
                    'ይልቀቅ... ለማደስት አርፉ' : 
                    'Dhiisii... Deebisuu fedhaa';
            } else {
                refreshText.textContent = currentLang === 'am' ? 
                    'ይቀናል... ለማደስት ከላይ ይሳቡ' : 
                    'Deebi\'aa... Harka keessan deebisuu fedhaa';
            }
        }
    }

    function handleTouchEnd() {
        if (!startY || isRefreshing) return;
        
        const deltaY = currentY - startY;
        
        if (deltaY > 80) {
            // Trigger refresh
            startRefresh();
        } else {
            // Reset
            resetRefresh();
        }
        
        startY = 0;
        currentY = 0;
    }

    function startRefresh() {
        isRefreshing = true;
        refreshContainer.style.top = '0';
        refreshSpinner.style.display = 'block';
        refreshText.textContent = currentLang === 'am' ? 
            'በማደስ ላይ...' : 
            'Kan deebisan...';
        
        // Simulate refresh action
        setTimeout(() => {
            completeRefresh();
        }, 1500);
    }

    function completeRefresh() {
        isRefreshing = false;
        
        // Perform actual refresh actions
        updateStreakUI();
        checkForUpdates();
        
        // Update recent orders
        initRecentOrders();
        
        // Show success message
        refreshText.textContent = currentLang === 'am' ? 
            'ተደስቷል!' : 
            'Milkaa\'e!';
        refreshSpinner.style.display = 'none';
        
        // Show toast
        showToast(currentLang === 'am' ? 
            'አፕዎ ተደስቷል!' : 
            'App keessan deebifame!', 2000);
        
        // Hide refresh container after delay
        setTimeout(() => {
            resetRefresh();
        }, 1000);
    }

    function resetRefresh() {
        refreshContainer.style.top = '-60px';
        refreshSpinner.style.display = 'none';
        refreshText.textContent = currentLang === 'am' ? 
            'ይቀናል... ለማደስት ከላይ ይሳቡ' : 
            'Deebi\'aa... Harka keessan deebisuu fedhaa';
        isRefreshing = false;
    }

    // Check for updates
    function checkForUpdates() {
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.ready.then(reg => {
                reg.update();
            });
        }
    }

    // Show location modal (called before sending to Telegram)
    function showLocationModal() {
        document.getElementById('locationModal').style.display = 'block';
    }

    // Request location permission
    function requestLocation() {
        document.getElementById('locationModal').style.display = 'none';
        
        if (!navigator.geolocation) {
            showToast(currentLang === 'am' ? 'አካባቢ አገልግሎት የለም' : 'Tajaajila bakkaa hin jiru', 3000);
            return;
        }
        
        showToast(currentLang === 'am' ? 'አካባቢዎ እየተመዘገበ...' : 'Bakka keessan kan barreeffamu...', 2000);
        
        const options = {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
        };
        
        navigator.geolocation.getCurrentPosition(
            (position) => {
                userLat = position.coords.latitude;
                userLng = position.coords.longitude;
                showToast(currentLang === 'am' ? 'አካባቢዎ ተመዝግቧል!' : 'Bakka keessan barreeffame!', 3000);
                
                sessionStorage.setItem('userLocation', JSON.stringify({
                    lat: userLat,
                    lng: userLng
                }));
                
                isLocationRequested = true;
                
                // Check if preorder was selected
                if (orderType === 'preorder') {
                    showPreorderModal();
                } else {
                    // Calculate distance and delivery fee
                    calculateDeliveryFee();
                    
                    // Show payment modal after getting location
                    showPaymentModal();
                }
            },
            (error) => {
                let errorMsg = currentLang === 'am' ? 'አካባቢ ማወቅ አልተቻለም' : 'Bakka beekuu hindandeenye';
                
                switch(error.code) {
                    case error.PERMISSION_DENIED:
                        errorMsg = currentLang === 'am' ? 'አካባቢ ፈቃድ አልተሰጠም' : 'Hayyama bakkaa hin kennine';
                        break;
                    case error.POSITION_UNAVAILABLE:
                        errorMsg = currentLang === 'am' ? 'አካባቢ መረጃ የለም' : 'Odeeffannoo bakkaa hin jiru';
                        break;
                    case error.TIMEOUT:
                        errorMsg = currentLang === 'am' ? 'አካባቢ መጠየቅ ጊዜው አልፏል' : 'Yeroo gaafannoo bakkaa darbee';
                        break;
                }
                
                showToast(errorMsg, 4000);
                
                // Even if location fails, check for preorder
                if (orderType === 'preorder') {
                    showPreorderModal();
                } else {
                    // Calculate delivery fee based on order type
                    calculateDeliveryFee();
                    showPaymentModal();
                }
            },
            options
        );
    }

    // Show preorder time selection modal
    function showPreorderModal() {
        document.getElementById('preorderModal').style.display = 'block';
    }

    // Confirm preorder time selection
    function confirmPreorderTime() {
        if (!preorderTimeSlot) {
            showToast(currentLang === 'am' ? 'እባክዎ የቅድመ ትዕዛዝ ሰዓት ይምረጡ' : 'Yeroo ordeeraa duraa filadhu', 3000);
            return;
        }
        
        document.getElementById('preorderModal').style.display = 'none';
        
        // Calculate delivery fee (preorder is fixed 50 birr)
        calculateDeliveryFee();
        
        // Show payment modal
        showPaymentModal();
    }

    // Cancel preorder
    function cancelPreorder() {
        document.getElementById('preorderModal').style.display = 'none';
        orderType = 'normal';
        selectOrderType('normal');
        showLocationModal();
    }

    // Deny location
    function denyLocation() {
        document.getElementById('locationModal').style.display = 'none';
        showToast(currentLang === 'am' ? 'አልፈልግም' : 'Hin barbaadu', 2000);
        isLocationRequested = false;
        
        // Check if preorder was selected
        if (orderType === 'preorder') {
            showPreorderModal();
        } else {
            // Calculate delivery fee based on order type
            calculateDeliveryFee();
            
            // Show payment modal
            showPaymentModal();
        }
    }

    // Calculate distance between two coordinates in kilometers
    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371; // Earth's radius in km
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
            Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
    }

    // Calculate delivery fee based on order type and distance to farthest restaurant
    function calculateDeliveryFee() {
        // Get selected items and their restaurants
        const selectedItems = [];
        const selectedRestaurants = new Set();
        
        document.querySelectorAll('input[type="checkbox"]:checked').forEach(box => {
            selectedItems.push(box.value);
            const restaurant = box.getAttribute('data-restaurant');
            if (restaurant) {
                selectedRestaurants.add(restaurant);
            }
        });
        
        // If no items selected, return
        if (selectedItems.length === 0) {
            deliveryFee = 0;
            calculatedDistance = 0;
            return;
        }
        
        // Check for special order types
        if (orderType === 'preorder') {
            // Preorder: Fixed 50 birr
            deliveryFee = 50;
            calculatedDistance = 0;
            return;
        }
        
        // Normal order: Calculate based on distance to farthest restaurant
        if (!userLat || !userLng) {
            // No location provided, use maximum fee
            deliveryFee = 99;
            calculatedDistance = 0;
            return;
        }
        
        // Calculate distance to each selected restaurant
        let maxDistance = 0;
        let farthestRestaurant = '';
        
        selectedRestaurants.forEach(restaurantName => {
            const restaurant = RESTAURANT_COORDINATES[restaurantName];
            if (restaurant) {
                const distance = calculateDistance(userLat, userLng, restaurant.lat, restaurant.lng);
                if (distance > maxDistance) {
                    maxDistance = distance;
                    farthestRestaurant = restaurantName;
                }
            }
        });
        
        calculatedDistance = maxDistance;
        
        // Check if beyond maximum delivery area
        if (calculatedDistance > MAX_DELIVERY_DISTANCE) {
            deliveryFee = 0; // Will show error in payment modal
            return;
        }
        
        // Calculate delivery fee based on distance to farthest restaurant
        if (isFirstOrder && FIRST_DELIVERY_FREE) {
            deliveryFee = 0; // First order free
        } else if (calculatedDistance <= 1) {
            deliveryFee = 50; // Within 1km
        } else {
            deliveryFee = 99; // Beyond 1km
        }
    }

    // Show payment modal
    function showPaymentModal() {
        // Get selected items and total
        let foodTotal = 0;
        let selectedItems = [];
        let selectedRestaurants = new Set();
        let selectedCount = 0;
        
        document.querySelectorAll('input[type="checkbox"]:checked').forEach(box => {
            selectedItems.push(box.value);
            foodTotal += parseInt(box.getAttribute('data-price'));
            selectedCount++;
            
            const restaurant = box.getAttribute('data-restaurant');
            if (restaurant) {
                selectedRestaurants.add(restaurant);
            }
        });
        
        // Calculate delivery fee based on order type
        calculateDeliveryFee();
        
        // Update order type display
        const orderTypeDisplay = document.getElementById('orderTypeText');
        const preorderTimeText = document.getElementById('preorderTimeText');
        let orderTypeText = '';
        let timeText = '';
        
        if (orderType === 'normal') {
            orderTypeText = currentLang === 'am' ? 
                '📦 አሁን እዘዝ' : 
                '📦 Amma Ajaji';
        } else if (orderType === 'preorder') {
            orderTypeText = currentLang === 'am' ? 
                '⏰ ቅድመ ትዕዛዝ' : 
                '⏰ Ordeer Duraa';
            
            // Add time slot info
            if (preorderTimeSlot === 'slot1') {
                timeText = currentLang === 'am' ? '4:30 PM - 6:30 PM' : '4:30 PM - 6:30 PM';
            } else if (preorderTimeSlot === 'slot2') {
                timeText = currentLang === 'am' ? '5:30 PM - 8:30 PM' : '5:30 PM - 8:30 PM';
            } else if (preorderTimeSlot === 'slot3') {
                timeText = currentLang === 'am' ? '9:30 PM - 11:00 PM' : '9:30 PM - 11:00 PM';
            }
        }
        
        orderTypeDisplay.innerHTML = orderTypeText;
        if (timeText) {
            preorderTimeText.innerHTML = timeText;
            preorderTimeText.style.display = 'block';
        } else {
            preorderTimeText.style.display = 'none';
        }
        
        // Update selected restaurants display
        const selectedRestaurantsDisplay = document.getElementById('selectedRestaurantsList');
        if (selectedRestaurantsDisplay) {
            let restaurantsText = Array.from(selectedRestaurants).join(', ');
            if (restaurantsText.length > 50) {
                restaurantsText = restaurantsText.substring(0, 47) + '...';
            }
            selectedRestaurantsDisplay.innerHTML = restaurantsText || 
                (currentLang === 'am' ? 'ምንም አልተመረጠም' : 'Hin filatamne');
        }
        
        // Update delivery fee display
        const deliveryFeeDetails = document.getElementById('deliveryFeeDetails');
        const totalAmount = foodTotal + deliveryFee;
        
        if (deliveryFeeDetails) {
            let feeText = '';
            
            // Check if beyond maximum delivery distance
            if (calculatedDistance > MAX_DELIVERY_DISTANCE && orderType === 'normal') {
                feeText = currentLang === 'am' ? 
                    `🚫 ከ${MAX_DELIVERY_DISTANCE} ኪ.ሜ በላይ አይሰራም! (ርቀት: ${calculatedDistance.toFixed(2)} ኪ.ሜ)` : 
                    `🚫 Kilomeetira ${MAX_DELIVERY_DISTANCE} ol hin hojjetu! (Fageenya: ${calculatedDistance.toFixed(2)} km)`;
            } else if (orderType === 'preorder') {
                feeText = currentLang === 'am' ? 
                    `ቅድመ ትዕዛዝ: 50 ብር` : 
                    `Ordeer Duraa: 50 Birraa`;
            } else if (isFirstOrder && FIRST_DELIVERY_FREE) {
                feeText = currentLang === 'am' ? 
                    `የመጀመሪያ ማድረሻ ነፃ! (ርቀት: ${calculatedDistance.toFixed(2)} ኪ.ሜ)` : 
                    `Ergaa jalqabaa bilisaa! (Fageenya: ${calculatedDistance.toFixed(2)} km)`;
            } else if (calculatedDistance > 0) {
                feeText = currentLang === 'am' ? 
                    `ርቀት: ${calculatedDistance.toFixed(2)} ኪ.ሜ • ክፍያ: ${deliveryFee} ብር` : 
                    `Fageenya: ${calculatedDistance.toFixed(2)} km • Kaffaltii: ${deliveryFee} Birraa`;
            } else {
                feeText = currentLang === 'am' ? 
                    `ክፍያ: ${deliveryFee} ብር` : 
                    `Kaffaltii: ${deliveryFee} Birraa`;
            }
            deliveryFeeDetails.innerHTML = feeText;
        }
        
        // Update order summary
        const orderSummaryDetails = document.getElementById('orderSummaryDetails');
        if (orderSummaryDetails) {
            let summaryText = currentLang === 'am' ? 
                `የተመረጡ እቃዎች: ${selectedCount}<br>` +
                `የምግብ ዋጋ: ${foodTotal} ብር<br>` +
                `የመላኪያ ክፍያ: ${deliveryFee} ብር<br>` +
                `<strong>ጠቅላላ: ${totalAmount} ብር</strong>` :
                `Nyaata filataman: ${selectedCount}<br>` +
                `Gatii nyaataa: ${foodTotal} Birraa<br>` +
                `Kaffaltii ergaa: ${deliveryFee} Birraa<br>` +
                `<strong>Waliigala: ${totalAmount} Birraa</strong>`;
            
            orderSummaryDetails.innerHTML = summaryText;
        }
        
        // Update confirm button based on delivery distance
        const confirmBtn = document.getElementById('confirmPaymentBtn');
        if (calculatedDistance > MAX_DELIVERY_DISTANCE && orderType === 'normal') {
            confirmBtn.disabled = true;
            confirmBtn.style.opacity = '0.6';
            confirmBtn.style.cursor = 'not-allowed';
            confirmBtn.innerHTML = `<i class="fas fa-ban"></i><span>${currentLang === 'am' ? 'ከ10 ኪ.ሜ በላይ' : 'Kilomeetira 10 ol'}</span>`;
        } else {
            confirmBtn.disabled = false;
            confirmBtn.style.opacity = '1';
            confirmBtn.style.cursor = 'pointer';
            confirmBtn.innerHTML = `<i class="fas fa-paper-plane"></i><span>${currentLang === 'am' ? 'ትዕዛዝ ላክ' : 'Ordeer Ergi'}</span>`;
        }
        
        // Show payment modal
        document.getElementById('paymentModal').style.display = 'block';
    }

    // Close payment modal
    function closePaymentModal() {
        document.getElementById('paymentModal').style.display = 'none';
    }

    // Confirm payment and proceed to phone number collection
    function confirmPayment() {
        // Check if beyond maximum delivery distance
        if (calculatedDistance > MAX_DELIVERY_DISTANCE && orderType === 'normal') {
            showToast(currentLang === 'am' ? `ከ${MAX_DELIVERY_DISTANCE} ኪ.ሜ በላይ አይሰራም!` : `Kilomeetira ${MAX_DELIVERY_DISTANCE} ol hin hojjetu!`, 4000);
            return;
        }
        
        closePaymentModal();
        
        // After payment confirmation, show phone number modal
        showPhoneNumberModal();
    }

    // Show phone number modal
    function showPhoneNumberModal() {
        document.getElementById('phoneModal').style.display = 'block';
    }

    // Submit phone number - FIXED: Always redirects to Telegram after submission
    function submitPhoneNumber() {
        const phoneInput = document.getElementById('userPhone');
        userPhone = phoneInput.value.trim();
        
        if (!userPhone) {
            showToast(currentLang === 'am' ? 'እባክዎ ስልክ ቁጥር ያስገቡ' : 'Lakkoofsa bilbila galchaa', 3000);
            return;
        }
        
        // Validate Ethiopian phone number
        if (!/^(09|07)\d{8}$/.test(userPhone)) {
            showToast(currentLang === 'am' ? 'ትክክለኛ ስልክ ቁጥር ያስገቡ (ምሳሌ: 0912345678)' : 'Lakkoofsa bilbila sirrii galchi (Fakkeenya: 0912345678)', 4000);
            return;
        }
        
        document.getElementById('phoneModal').style.display = 'none';
        showToast(currentLang === 'am' ? 'ስልክ ቁጥር ተመዝግቧል!' : 'Lakkoofsa bilbila barreeffame!', 2000);
        
        // Proceed to send to Telegram - FIXED: This will now always execute
        sendOrderToTelegram();
    }

    // Skip phone number
    function skipPhoneNumber() {
        document.getElementById('phoneModal').style.display = 'none';
        userPhone = '';
        showToast(currentLang === 'am' ? 'ስልክ ቁጥር ተዘልሏል' : 'Lakkoofsa bilbila dabalamtee', 2000);
        
        // Proceed to send to Telegram
        sendOrderToTelegram();
    }

    // Show PWA popup after 5 seconds (CHANGED FROM 10)
   function showPWApopup() {
  const isInstalled = localStorage.getItem('pwaInstalled') === 'true';
  const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
  const isDismissed = localStorage.getItem('pwaPopupDismissed') === 'true';
  
  if (isInstalled || isStandalone || isDismissed) return;
  
  const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
  const isAndroid = /Android/.test(navigator.userAgent);
  
  // Show different message based on device
  if (isIOS) {
    document.querySelector('.pwa-title').textContent = currentLang === 'am' 
      ? 'ወደ መነሻ ማውጫ ጨምር' 
      : 'Home Screen Dabaladhu';
    document.querySelector('.pwa-message').innerHTML = currentLang === 'am'
      ? 'ለፈጣን መዳረሻ፡<br>1. የማጋራት አዶን ይጫኑ<br>2. "ወደ መነሻ ማውጫ ጨምር" ይምረጡ<br>3. "አክል" ይጫኑ'
      : 'Ariifachiifachuuf:<br>1. Share button cuqi<br>2. "Add to Home Screen" filadhu<br>3. "Add" cuqi';
  }
  
  document.getElementById('pwaPopup').style.display = 'block';
}

    // Install PWA - IMPROVED: Shows install button on Chrome
function installPWA() {
  const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
  
  if (isIOS) {
    // iOS requires manual installation
    showIOSInstallInstructions();
    hidePWApopup();
    localStorage.setItem('pwaPopupDismissed', 'true');
  } else if (deferredPrompt) {
    // Android Chrome - use standard PWA install
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then(choice => {
      if (choice.outcome === 'accepted') {
        localStorage.setItem('pwaInstalled', 'true');
        hidePWApopup();
        if (installButton) installButton.style.display = 'none';
        showToast(currentLang === 'am' ? 'አፕዎ ተጫኗል!' : 'App keessan sirreessame!', 3000);
      } else {
        dismissPWA();
      }
      deferredPrompt = null;
    });
  } else {
    // Fallback for other browsers
    showManualInstall();
  }
}
    function showIOSInstallInstructions() {
  const instructions = currentLang === 'am'
    ? 'ለአይፎን/አይፓድ:\n\n' +
      '1. 📱 በሳፋሪ ላይ የማጋራት አዶን ይጫኑ\n' +
      '2. ➕ "ወደ መነሻ ማውጫ ጨምር" ይምረጡ\n' +
      '3. ✅ "አክል" የሚለውን ይጫኑ'
    : 'iPhone/iPad:\n\n' +
      '1. 📱 Safari irratti share button cuqi\n' +
      '2. ➕ "Add to Home Screen" filadhu\n' +
      '3. ✅ "Add" cuqi';
  
  alert(currentLang === 'am' ? 'እንዴት አፕን እንደሚጨምሩ:\n\n' + instructions : 
        'App maal akka dabalattu:\n\n' + instructions);
}
    // Show floating install button
    function showInstallButton() {
        if (!deferredPrompt) return;
        
        // Check if already installed
        const isInstalled = localStorage.getItem('pwaInstalled') === 'true';
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
        
        if (!isInstalled && !isStandalone) {
            installButton.style.display = 'flex';
        }
    }

    // Dismiss PWA
    function dismissPWA() {
        hidePWApopup();
        localStorage.setItem('pwaPopupDismissed', 'true');
        showToast(currentLang === 'am' ? 'እሺ፣ በኋላ ላይ እንደገና እናሳይዎታለን' : 'OK, booda irratti ni agarsiifna', 2000);
    }

    function hidePWApopup() {
        document.getElementById('pwaPopup').style.display = 'none';
    }

    function showManualInstall() {
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
        const isAndroid = /Android/.test(navigator.userAgent);
        const isDesktop = !isIOS && !isAndroid;
        
        let instructions = '';
        
        if (isIOS) {
            instructions = currentLang === 'am' ? 
                'ለአይፎን/አይፓድ:\n' +
                '1. በሳፋሪ ላይ የማጋራት አዶን ይጫኑ\n' +
                '2. "ወደ መነሻ ማውጫ ጨምር" ይምረጡ\n' +
                '3. "አክል" የሚለውን ይጫኑ' :
                'iPhone/iPad:\n' +
                '1. Share button cuqi\n' +
                '2. "Add to Home Screen" filadhu\n' +
                '3. "Add" cuqi';
        } else if (isAndroid) {
            instructions = currentLang === 'am' ? 
                'ለአንድሮይድ:\n' +
                '1. በቻሮም ላይ ሶስት ነጥብ ይጫኑ\n' +
                '2. "ወደ መነሻ ማውጫ ጨምር" ይምረጡ\n' +
                '3. "አክል" የሚለውን ይጫኑ' :
                'Android:\n' +
                '1. Dots sadi cuqi\n' +
                '2. "Add to Home Screen" filadhu\n' +
                '3. "Add" cuqi';
        } else if (isDesktop) {
            instructions = currentLang === 'am' ? 
                'ለኮምፒውተር/ላፕቶፕ:\n' +
                '1. በቻሮም ላይ የመጫን አዶን ይጫኑ\n' +
                '2. "ጫን" የሚለውን ይጫኑ\n' +
                '3. አፕው ወደ መነሻ ማውጫዎ ይጨመራል' :
                'Kompiutara/Laptop:\n' +
                '1. Install button cuqi\n' +
                '2. "Install" cuqi\n' +
                '3. App home screen keessan irratti dabalama';
        } else {
            instructions = currentLang === 'am' ? 'እባክዎ ስልክዎን ይጠቀሙ' : 'Mobil keessan fayyadamaa';
        }
        
        alert(currentLang === 'am' ? 'እንዴት አፕን እንደሚጨምሩ:\n\n' + instructions : 
              'App maal akka dabalattu:\n\n' + instructions);
        hidePWApopup();
    }

    // Initialize PWA with better cross-device support
    function initPWA() {
        // Check if service workers are supported
        if ('serviceWorker' in navigator) {
            // Register service worker with updated scope
            navigator.serviceWorker.register('./service-worker.js?v=14.3', { scope: './' })
                .then(reg => {
                    console.log('Service Worker registered successfully:', reg.scope);
                    
                    // Check for updates periodically
                    setInterval(() => {
                        reg.update();
                    }, 60 * 60 * 1000); // Check every hour
                })
                .catch(err => {
                    console.log('Service Worker registration failed:', err);
                });
        }

        // Handle beforeinstallprompt event for PWA install prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or notification after a delay
            setTimeout(() => {
                if (deferredPrompt) {
                    showPWApopup();
                    showInstallButton();
                }
            }, 3000);
        });

        // Handle app installed event
        window.addEventListener('appinstalled', () => {
            hidePWApopup();
            localStorage.setItem('pwaInstalled', 'true');
            installButton.style.display = 'none';
            showToast(currentLang === 'am' ? 'አፕዎ ተጫኗል!' : 'App keessan sirreessame!', 3000);
        });

        // Check if app is running in standalone mode (already installed)
        if (window.matchMedia('(display-mode: standalone)').matches) {
            localStorage.setItem('pwaInstalled', 'true');
            installButton.style.display = 'none';
        }
    }

    // Update online/offline status
    function updateOnlineStatus() {
        const isOnline = navigator.onLine;
        offlineIndicator.style.display = isOnline ? 'none' : 'block';
        
        if (!isOnline) {
            offlineIndicator.textContent = currentLang === 'am' ? 
                'ኦፍላይን ሁነዋል' : 
                'Ilaalcha hin jiru';
        }
    }

    // Update streak UI
    function updateStreakUI() {
        const s = parseInt(localStorage.getItem('userStreak')) || 0;
        for(let i=1; i<=3; i++) {
            const elem = document.getElementById('s'+i);
            if (elem) {
                elem.classList.toggle('active', i <= s);
            }
        }
    }

    // Show toast
    function showToast(message, duration = 3000) {
        toast.textContent = message;
        toast.style.display = 'block';
        toast.style.animation = 'none';
        setTimeout(() => {
            toast.style.animation = 'fadeInOut 3s ease';
        }, 10);
        
        setTimeout(() => {
            toast.style.display = 'none';
        }, duration);
    }

    function openCheckout() {
        let foodTotal = 0;
        let selected = [];
        document.querySelectorAll('input[type="checkbox"]:checked').forEach(box => {
            selected.push(box.value);
            foodTotal += parseInt(box.getAttribute('data-price'));
        });

        if(selected.length === 0) {
            alert(currentLang === 'am' ? 
                "እባክዎ ቢያንስ አንድ ምግብ ይምረጡ!" : 
                "Yoo xinna tokko nyaata filadhu!");
            return;
        }
        
        orderData = { 
            name: "Customer",
            phone: userPhone || "Not Provided",
            landmark: "Not Provided",
            items: selected.join(", "), 
            foodTotal,
            paymentMethod: selectedPaymentMethod,
            deliveryFee: deliveryFee,
            distance: calculatedDistance,
            isFirstOrderFree: isFirstOrder && FIRST_DELIVERY_FREE,
            orderType: orderType,
            preorderTimeSlot: preorderTimeSlot
        };
        
        // Show location modal before payment modal
        if (!isLocationRequested) {
            showLocationModal();
        } else {
            // If location already requested, calculate fee and show payment modal
            calculateDeliveryFee();
            showPaymentModal();
        }
    }

    // Send order to Telegram (after getting phone number) - FIXED: Always redirects
    function sendOrderToTelegram() {
        localStorage.setItem('lastOrder', JSON.stringify(orderData));
        
        // Add to recent orders
        addToRecentOrders(orderData.items);
        
        // Mark first order as completed
        if (isFirstOrder) {
            localStorage.setItem('firstOrderMade', 'true');
            isFirstOrder = false;
        }
        
        // Use saved location if available
        const savedLocation = sessionStorage.getItem('userLocation');
        if (savedLocation && !userLat && !userLng) {
            const loc = JSON.parse(savedLocation);
            userLat = loc.lat;
            userLng = loc.lng;
            calculateDeliveryFee(); // Recalculate with saved location
        }
        
        const message = createOrderMessage();
        const encodedMessage = encodeURIComponent(message);
        const telegramUrl = `https://t.me/${BOT_USERNAME}?text=${encodedMessage}`;
        
        // FIXED: Always open Telegram
        window.open(telegramUrl, '_blank');
        
        setTimeout(() => {
            alert(currentLang === 'am' ? 
                "ትዕዛዝዎ ተልኳል!\n\nወደ ቴሌግራም ተላክዎታል። መልእክቱ ከተከፈተ በኋላ 'SEND' የሚለውን ይጫኑ።" :
                "Dhaadannoo keessan ergame!\n\nTelegiraamiin ergame. Ergaa bane booda 'SEND' cuqi.");
            clearForm();
        }, 500);
    }

    // Create order message
    function createOrderMessage() {
        let locationInfo = "";
        let deliveryPriceInfo = "";
        let mapUrl = "";
        let totalItemsPrice = orderData.foodTotal;
        
        const totalAmount = totalItemsPrice + deliveryFee;
        
        // Get selected restaurants
        const selectedRestaurants = new Set();
        document.querySelectorAll('input[type="checkbox"]:checked').forEach(box => {
            const restaurant = box.getAttribute('data-restaurant');
            if (restaurant) selectedRestaurants.add(restaurant);
        });
        
        if (userLat && userLng) {
            locationInfo = `Location: ${userLat.toFixed(6)}, ${userLng.toFixed(6)}`;
            mapUrl = `Map: https://www.google.com/maps?q=${userLat},${userLng}`;
            
            deliveryPriceInfo = 
                `Distance from farthest restaurant: ${calculatedDistance.toFixed(2)} km\n` +
                `Food Items Total: ${totalItemsPrice} ETB\n` +
                `Delivery Fee: ${deliveryFee} ETB ${orderData.isFirstOrderFree ? '(FIRST ORDER FREE!)' : ''}\n` +
                `Order Type: ${orderType.toUpperCase()} ${orderType === 'preorder' ? '(50 ETB)' : ''}\n`;
                
            if (orderType === 'preorder' && preorderTimeSlot) {
                let timeSlotText = '';
                if (preorderTimeSlot === 'slot1') timeSlotText = '4:30 PM - 6:30 PM';
                else if (preorderTimeSlot === 'slot2') timeSlotText = '5:30 PM - 8:30 PM';
                else if (preorderTimeSlot === 'slot3') timeSlotText = '9:30 PM - 11:00 PM';
                deliveryPriceInfo += `Preorder Time: ${timeSlotText}\n`;
            }
            
            deliveryPriceInfo += `TOTAL: ${totalAmount} ETB\n`;
        } else {
            locationInfo = "Location: Not provided";
            deliveryPriceInfo = 
                `Food Items Total: ${totalItemsPrice} ETB\n` +
                `Delivery Fee: ${deliveryFee} ETB ${orderData.isFirstOrderFree ? '(FIRST ORDER FREE!)' : ''}\n` +
                `Order Type: ${orderType.toUpperCase()} ${orderType === 'preorder' ? '(50 ETB)' : ''}\n`;
                
            if (orderType === 'preorder' && preorderTimeSlot) {
                let timeSlotText = '';
                if (preorderTimeSlot === 'slot1') timeSlotText = '4:30 PM - 6:30 PM';
                else if (preorderTimeSlot === 'slot2') timeSlotText = '5:30 PM - 8:30 PM';
                else if (preorderTimeSlot === 'slot3') timeSlotText = '9:30 PM - 11:00 PM';
                deliveryPriceInfo += `Preorder Time: ${timeSlotText}\n`;
            }
            
            deliveryPriceInfo += `TOTAL: ${totalAmount} ETB\n`;
        }
        
        // Streak Logic
        if(orderData.foodTotal >= 600) {
            let streak = parseInt(localStorage.getItem('userStreak')) || 0;
            let last = localStorage.getItem('lastDate');
            let today = new Date().toDateString();
            if(last !== today) {
                streak = (last === new Date(Date.now() - 86400000).toDateString()) ? streak + 1 : 1;
                localStorage.setItem('userStreak', streak);
                localStorage.setItem('lastDate', today);
                updateStreakUI();
            }
        }
        
        // Payment method info
        const paymentMethodInfo = selectedPaymentMethod === 'cash' ? 
            'Payment Method: Cash on Delivery (Pay after receiving your food)' :
            'Payment Method: Telegram Payment';
        
        // Restaurant info
        const restaurantInfo = `Restaurants: ${Array.from(selectedRestaurants).join(', ')}`;
        
        return `/order\n` +
               `Name: ${orderData.name}\n` +
               `Phone: ${orderData.phone}\n` +
               `Landmark: ${orderData.landmark}\n` +
               `${restaurantInfo}\n` +
               `${locationInfo}\n` +
               `${mapUrl}\n\n` +
               `Items:\n${orderData.items}\n\n` +
               `${deliveryPriceInfo}\n` +
               `${paymentMethodInfo}\n` +
               `Time: ${new Date().toLocaleString('am-ET')}\n` +
               `Order ID: BD${Date.now().toString().slice(-8)}\n\n` +
               `This is a TEST order for user interest gathering`;
    }

    function clearForm() {
        // Clear checkboxes
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
        updateCartCount();
        
        // Reset form data
        userPhone = '';
        deliveryFee = 0;
        calculatedDistance = 0;
        orderType = 'normal';
        preorderTimeSlot = '';
        selectOrderType('normal');
    }
</script>
</body> 
</html>
